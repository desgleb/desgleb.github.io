"use strict";(self["webpackChunkvue_cash"]=self["webpackChunkvue_cash"]||[]).push([[765],{6765:function(t,i,e){e.r(i),e.d(i,{default:function(){return Y}});var l=e(3396);const a=t=>((0,l.dD)("data-v-1436f386"),t=t(),(0,l.Cn)(),t),s=a((()=>(0,l._)("div",{class:"page-title"},[(0,l._)("h3",null,"Категории")],-1))),n={key:1,class:"row"},r={key:1,class:"center"};function d(t,i,e,a,d,u){const o=(0,l.up)("Loader"),c=(0,l.up)("AddCategory"),m=(0,l.up)("EditCategory");return(0,l.wg)(),(0,l.iD)("div",null,[s,(0,l._)("section",null,[d.loading?((0,l.wg)(),(0,l.j4)(o,{key:0})):((0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(c,{onCreated:u.addNewCategory},null,8,["onCreated"]),d.categories.length?((0,l.wg)(),(0,l.j4)(m,{key:d.categories.length+d.updateCount,categories:d.categories,onUpdated:u.updateCategories},null,8,["categories","onUpdated"])):((0,l.wg)(),(0,l.iD)("p",r,"Создайте хотя бы одну категорию"))]))])])}e(7658);var u=e(9242),o=e(7139);const c={class:"col s12 m6"},m=(0,l._)("div",{class:"page-subtitle"},[(0,l._)("h4",null,"Создать")],-1),h={class:"input-field"},v=(0,l._)("label",{for:"name"},"Название",-1),p={key:0,class:"helper-text invalid"},g={class:"input-field"},$=(0,l._)("label",{for:"limit"},"Лимит",-1),y={key:0,class:"helper-text invalid"},_=(0,l._)("button",{class:"btn waves-effect waves-light",type:"submit"},[(0,l.Uk)(" Создать "),(0,l._)("i",{class:"material-icons right"},"send")],-1);function w(t,i,e,a,s,n){return(0,l.wg)(),(0,l.iD)("div",c,[(0,l._)("div",null,[m,(0,l._)("form",{onSubmit:i[2]||(i[2]=(0,u.iM)(((...t)=>n.submitHandler&&n.submitHandler(...t)),["prevent"]))},[(0,l._)("div",h,[(0,l.wy)((0,l._)("input",{id:"name",type:"text","onUpdate:modelValue":i[0]||(i[0]=t=>s.title=t),class:(0,o.C_)({invalid:a.v$.title.$dirty&&n.titleRequired})},null,2),[[u.nr,s.title]]),v,a.v$.title.$dirty&&n.titleRequired?((0,l.wg)(),(0,l.iD)("span",p,"Введите название категории")):(0,l.kq)("",!0)]),(0,l._)("div",g,[(0,l.wy)((0,l._)("input",{id:"limit",type:"number","onUpdate:modelValue":i[1]||(i[1]=t=>s.limit=t),class:(0,o.C_)({invalid:a.v$.limit.$dirty&&n.limitMinValid})},null,2),[[u.nr,s.limit,void 0,{number:!0}]]),$,a.v$.limit.$dirty&&n.limitMinValid?((0,l.wg)(),(0,l.iD)("span",y,"Минимальная величина "+(0,o.zw)(n.limitMinValue),1)):(0,l.kq)("",!0)]),_],32)])])}var f=e(4219),b=e(5420),C={setup(){return{v$:(0,f.Xw)()}},name:"AddCategory",data(){return{title:"",limit:100}},validations(){return{title:{required:b.C1},limit:{minValue:(0,b.uv)(100)}}},computed:{titleRequired(){return this.v$.title.required.$invalid},limitMinValid(){return this.v$.limit.minValue.$invalid},limitMinValue(){return this.v$.limit.minValue.$params.min}},methods:{async submitHandler(){if(this.v$.$invalid)this.v$.$touch();else try{const t=await this.$store.dispatch("addCategory",{title:this.title,limit:this.limit});this.title="",this.limit=this.limitMinValue,this.v$.$reset(),this.$message("Категория успешно создана"),this.$emit("created",t)}catch(t){console.log(t)}}},mounted(){M.updateTextFields()}},V=e(89);const k=(0,V.Z)(C,[["render",w]]);var q=k;const D={class:"col s12 m6"},U=(0,l._)("div",{class:"page-subtitle"},[(0,l._)("h4",null,"Редактировать")],-1),x={class:"input-field"},H=["value"],R=(0,l._)("label",null,"Выберите категорию",-1),A={class:"input-field"},Z=(0,l._)("label",{for:"name"},"Название",-1),z={key:0,class:"helper-text invalid"},E={class:"input-field"},F=(0,l._)("label",{for:"limit"},"Лимит",-1),S={key:0,class:"helper-text invalid"},j=(0,l._)("button",{class:"btn waves-effect waves-light",type:"submit"},[(0,l.Uk)(" Обновить "),(0,l._)("i",{class:"material-icons right"},"send")],-1);function I(t,i,e,a,s,n){return(0,l.wg)(),(0,l.iD)("div",D,[(0,l._)("div",null,[U,(0,l._)("form",{onSubmit:i[3]||(i[3]=(0,u.iM)(((...t)=>n.submitHandler&&n.submitHandler(...t)),["prevent"]))},[(0,l._)("div",x,[(0,l.wy)((0,l._)("select",{ref:"select","onUpdate:modelValue":i[0]||(i[0]=t=>s.current=t)},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.categories,(t=>((0,l.wg)(),(0,l.iD)("option",{key:t.id,value:t.id},(0,o.zw)(t.title),9,H)))),128))],512),[[u.bM,s.current]]),R]),(0,l._)("div",A,[(0,l.wy)((0,l._)("input",{id:"name",type:"text","onUpdate:modelValue":i[1]||(i[1]=t=>s.title=t),class:(0,o.C_)({invalid:a.v$.title.$dirty&&n.titleRequired})},null,2),[[u.nr,s.title]]),Z,a.v$.title.$dirty&&n.titleRequired?((0,l.wg)(),(0,l.iD)("span",z,"Введите название категории")):(0,l.kq)("",!0)]),(0,l._)("div",E,[(0,l.wy)((0,l._)("input",{id:"limit",type:"number","onUpdate:modelValue":i[2]||(i[2]=t=>s.limit=t),class:(0,o.C_)({invalid:a.v$.limit.$dirty&&n.limitMinValid})},null,2),[[u.nr,s.limit,void 0,{number:!0}]]),F,a.v$.limit.$dirty&&n.limitMinValid?((0,l.wg)(),(0,l.iD)("span",S,"Минимальная величина "+(0,o.zw)(n.limitMinValue),1)):(0,l.kq)("",!0)]),j],32)])])}var L={setup(){return{v$:(0,f.Xw)()}},props:{categories:{type:Array,required:!0}},name:"EditCategory",data(){return{select:null,title:"",limit:100,current:null}},validations(){return{title:{required:b.C1},limit:{minValue:(0,b.uv)(100)}}},computed:{titleRequired(){return this.v$.title.required.$invalid},limitMinValid(){return this.v$.limit.minValue.$invalid},limitMinValue(){return this.v$.limit.minValue.$params.min}},methods:{async submitHandler(){if(this.v$.$invalid)this.v$.$touch();else try{const t={id:this.current,title:this.title,limit:this.limit};await this.$store.dispatch("updateCategory",t),this.$message("Категория успешно обновлена"),this.$emit("updated",t)}catch(t){}}},watch:{current(t){const{title:i,limit:e}=this.categories.find((i=>i.id===t));this.title=i,this.limit=e}},created(){const{id:t,title:i,limit:e}=this.categories[0];this.current=t,this.title=i,this.limit=e},mounted(){this.select=M.FormSelect.init(this.$refs.select),M.updateTextFields()},beforeUnmount(){this.select&&this.select.destroy&&this.select.destroy()}};const N=(0,V.Z)(L,[["render",I]]);var T=N,X=e(8412),K={name:"Categories",components:{Loader:X.Z,AddCategory:q,EditCategory:T},data(){return{categories:[],loading:!0,updateCount:0}},methods:{addNewCategory(t){console.log(t),this.categories.push(t)},updateCategories(t){const i=this.categories.findIndex((i=>i.id===t.id));this.categories[i].title=t.title,this.categories[i].limit=t.limit,this.updateCount++}},async mounted(){this.categories=await this.$store.dispatch("fetchCategories"),this.loading=!1}};const W=(0,V.Z)(K,[["render",d],["__scopeId","data-v-1436f386"]]);var Y=W}}]);
//# sourceMappingURL=765.23ef964b.js.map