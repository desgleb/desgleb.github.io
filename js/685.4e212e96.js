"use strict";(self["webpackChunkmoney_catcher"]=self["webpackChunkmoney_catcher"]||[]).push([[685],{5632:function(e,a,t){t.d(a,{Z:function(){return y}});var l=t(3396),r=t(4870),n=t(7139),i=t(9242),o=t(9545),d=t(1020);const c={class:"input-field"},s={key:0,selected:"",value:"12"},u=["value"],v=(0,l._)("label",null,"Фильтрация по месяцам",-1);var m=(0,l.aZ)({__name:"MonthSelectComponent",props:{showAll:{type:Boolean}},setup(e){const{transactionsMonthFilter:a}=(0,d.Jk)((0,o.C)()),t=(0,r.iH)(),m=(0,r.iH)(),_=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];return(0,l.bv)((()=>{m.value=M.FormSelect.init(t.value)})),(e,o)=>((0,l.wg)(),(0,l.iD)("div",c,[(0,l.wy)((0,l._)("select",{ref_key:"monthSelect",ref:t,"onUpdate:modelValue":o[0]||(o[0]=e=>(0,r.dq)(a)?a.value=e:null)},[e.$props.showAll?((0,l.wg)(),(0,l.iD)("option",s,"Показать всё")):(0,l.kq)("",!0),((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(_,((e,a)=>(0,l._)("option",{key:a,value:a},(0,n.zw)(e),9,u))),64))],512),[[i.bM,(0,r.SU)(a),void 0,{number:!0}]]),v]))}});const _=m;var y=_},6838:function(e,a,t){t.d(a,{Z:function(){return y}});t(560);var l=t(3396),r=t(4870),n=t(7139),i=t(9242),o=t(9545),d=t(1020),c=t(3060);const s={class:"input-field"},u=["value"],v=(0,l._)("label",null,"Фильтрация по годам",-1);var m=(0,l.aZ)({__name:"YearSelectComponent",setup(e){const{transactions:a,transactionsYearFilter:t}=(0,d.Jk)((0,o.C)()),{isGlobalLoading:m}=(0,d.Jk)((0,c.e)());m.value=!0;const _=(0,r.iH)(),y=(0,r.iH)(),g=(0,l.Fl)((()=>{const e=[],t=new Set;t.add((new Date).getFullYear()),a.value.forEach((e=>{const a=new Date(e.date).getFullYear();t.add(a)}));const l=Math.max.apply(null,Array.from(t))+1;t.add(l);const r=Array.from(t).sort(((e,a)=>e-a));return r.forEach((a=>{const t={year:a,id:Math.floor(1e6*Math.random())};e.push(t)})),m.value=!1,e}));return(0,l.bv)((()=>{y.value=M.FormSelect.init(_.value)})),(0,l.ic)((()=>{y.value=M.FormSelect.init(_.value)})),(e,a)=>((0,l.wg)(),(0,l.iD)("div",s,[(0,l.wy)((0,l._)("select",{ref_key:"yearSelect",ref:_,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,r.dq)(t)?t.value=e:null)},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(g.value,(e=>((0,l.wg)(),(0,l.iD)("option",{key:e.id,value:e.year},(0,n.zw)(e.year),9,u)))),128))],512),[[i.bM,(0,r.SU)(t),void 0,{number:!0}]]),v]))}});const _=m;var y=_},2685:function(e,a,t){t.r(a),t.d(a,{default:function(){return X}});var l=t(3396),r=(t(560),t(7139)),n=t(4870),i=t(3256),o=t(9545),d=t(1520),c=t(6135),s=t(8263),u=t(1020);const v=e=>((0,l.dD)("data-v-19b988bc"),e=e(),(0,l.Cn)(),e),m={class:"day-card__header"},_={class:"row valign-wrapper"},y={class:"col s12"},g={class:"center-align day-card__date"},f={class:"row valign-center blue lighten-3"},w={class:"col s12"},p={class:"center-align day-card__balance"},F={key:0,class:"valign-center"},b={class:"col s12 red white-text"},h=v((()=>(0,l._)("div",{class:"center-align day-card__overspending"},"Не учтено ",-1))),k={class:"center-align day-card__overspending"},D={class:"day-card__section day-card__section-income green lighten-4"},N={class:"center-align day-card__income-list-item"},x={class:"day-card__section day-card__section-outcome orange lighten-4"},S={class:"center-align day-card__income-list-item"},C={class:"center-align day-card__income-list"},U={class:"day-card__section day-card__section-outcome red lighten-3"},z={class:"center-align day-card__income-list-item"},I={class:"center-align day-card__income-list"},M={class:"day-card__footer"},T={class:"valign-center"},Y={class:"col s12"};var Z=(0,l.aZ)({__name:"CalendarDayCardComponent",props:{day:{}},setup(e){const a=e,{dateFilter:t,currencyFilter:v}=(0,i.y)(),{transactions:Z,transactionsSortedByDate:H}=(0,u.Jk)((0,o.C)()),{categoriesAvailableForLimitation:J}=(0,u.Jk)((0,d.x)()),{limits:P}=(0,u.Jk)((0,c.L)()),{accounts:A}=(0,u.Jk)((0,s.o)()),K=new Date(a.day.year,a.day.month,a.day.day).getTime(),W=new Date(a.day.year,a.day.month,a.day.day+1).getTime(),q=new Date(a.day.year,a.day.month,0).getDate(),B=new Date(a.day.year,a.day.month-1,q).getTime(),L=(0,l.Fl)((()=>A.value.map((e=>{const a=Z.value.filter((e=>"transfer"===e.type)).filter((e=>e.date<K)).reduce(((a,t)=>t.accountId===e.id?Number((a-t.amount).toFixed(2)):t.categoryId===e.id?Number((a+t.amount).toFixed(2)):Number(a.toFixed(2))),0),t=Z.value.filter((a=>a.accountId===e.id)).filter((e=>"income"===e.type)).filter((e=>e.date<K)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0),l=Z.value.filter((a=>a.accountId===e.id)).filter((e=>"outcome"===e.type)).filter((e=>e.date<K)).reduce(((e,a)=>Number((e-a.amount).toFixed(2))),0);let r;return r=e.isCountable?e.initialBalance+a+t+l:0,{...e,resultSumTillToday:r}})).reduce(((e,a)=>Number((e+a.resultSumTillToday).toFixed(2))),0))),V=(0,l.Fl)((()=>A.value.map((e=>{const a=H.value.filter((e=>"transfer"===e.type)).filter((e=>e.date===K)).reduce(((a,t)=>t.accountId!==e.id||e.isCountable?t.categoryId!==e.id||e.isCountable?Number(a.toFixed(2)):Number((a-t.amount).toFixed(2)):Number((a+t.amount).toFixed(2))),0);return{...e,transfersToday:a}})).reduce(((e,a)=>Number((e+a.transfersToday).toFixed(2))),0))),E=(0,l.Fl)((()=>Number(L.value+$.value-Q.value-R.value))),G=(0,l.Fl)((()=>J.value.map((e=>{const a=H.value.filter((e=>e.date>=K)).filter((e=>e.date<W)).filter((e=>!e.isNotPlanned)).filter((a=>a.categoryId===e.id)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0),t=P.value.find((a=>a.categoryId===e.id))?.limit||0,l=t>0&&a-t>0?Number((a-t).toFixed(2)):0;return{...e,overspend:l}})).filter((e=>e.overspend>0)).reduce(((e,a)=>Number((e+a.overspend).toFixed(2))),0))),j=(0,l.Fl)((()=>H.value.filter((e=>"transfer"!==e.type)).filter((e=>e.date<W)).filter((e=>e.date>=K)))),$=(0,l.Fl)((()=>{const e=j.value.filter((e=>"income"===e.type)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0),a=V.value>0?e+V.value:e;return Number(a.toFixed(2))})),O=(0,l.Fl)((()=>j.value.filter((e=>"outcome"===e.type)).filter((e=>!e.isNotPlanned)))),Q=(0,l.Fl)((()=>{const e=O.value.reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0),a=V.value<0?e+Math.abs(V.value):e;return Number(a.toFixed(2))})),R=(0,l.Fl)((()=>j.value.filter((e=>"outcome"===e.type)).filter((e=>e.isNotPlanned)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0))),X=(0,l.Fl)((()=>H.value.filter((e=>e.isNotPlanned)).filter((e=>e.date>B)).filter((e=>e.date<=K)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0))),ee=(0,l.Fl)((()=>J.value.map((e=>{const a=j.value.filter((e=>!e.isNotPlanned)).filter((a=>a.categoryId===e.id)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0),t=j.value.filter((a=>a.categoryId===e.id)).filter((e=>"outcome"===e.type)).find((e=>e.isForecast)),l=!!t&&t.isForecast;return{...e,total:a,hasForecast:l}})).filter((e=>0!==e.total)))),ae=(0,l.Fl)((()=>J.value.map((e=>{const a=j.value.filter((e=>e.isNotPlanned)).filter((a=>a.categoryId===e.id)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0);return{...e,total:a}})).filter((e=>0!==e.total))));return(e,a)=>((0,l.wg)(),(0,l.iD)("article",{class:(0,r.C_)([{"border-red":E.value<0},"card-panel grey lighten-2 calendar-list__card day-card"])},[(0,l._)("header",m,[(0,l._)("div",_,[(0,l._)("div",y,[(0,l._)("div",g,(0,r.zw)((0,n.SU)(t)((0,n.SU)(K))),1)])]),(0,l._)("div",f,[(0,l._)("div",w,[(0,l._)("div",p,[(0,l._)("strong",null,"Утром "+(0,r.zw)((0,n.SU)(v)(L.value)),1)])])]),X.value+G.value>0?((0,l.wg)(),(0,l.iD)("div",F,[(0,l._)("div",b,[h,(0,l._)("div",k,(0,r.zw)((0,n.SU)(v)(X.value+G.value)),1)])])):(0,l.kq)("",!0)]),(0,l._)("section",D,[(0,l._)("div",N,[(0,l._)("strong",null,"Доход "+(0,r.zw)((0,n.SU)(v)($.value)),1)])]),(0,l._)("section",x,[(0,l._)("div",S,[(0,l._)("strong",null,"Расход "+(0,r.zw)((0,n.SU)(v)(Q.value)),1)]),(0,l._)("ul",C,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(ee.value,(e=>((0,l.wg)(),(0,l.iD)("li",{key:e.id,class:(0,r.C_)([{"grey-text":e["hasForecast"]},"day-card__income-list-item"])},(0,r.zw)(e.name)+" - "+(0,r.zw)((0,n.SU)(v)(e["total"])),3)))),128))])]),(0,l._)("section",U,[(0,l._)("div",z,[(0,l._)("strong",null,"Вне плана "+(0,r.zw)((0,n.SU)(v)(R.value)),1)]),(0,l._)("ul",I,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(ae.value,(e=>((0,l.wg)(),(0,l.iD)("li",{key:e.id,class:"day-card__income-list-item"},(0,r.zw)(e.name)+" - "+(0,r.zw)((0,n.SU)(v)(e["total"])),1)))),128))])]),(0,l._)("footer",M,[(0,l._)("div",T,[(0,l._)("div",Y,[(0,l._)("div",{class:(0,r.C_)([{"red lighten-4":E.value<0,green:E.value>=0},"center-align day-card__balance"])},[(0,l._)("strong",null,"Вечером "+(0,r.zw)((0,n.SU)(v)(E.value)),1)],2)])])])],2))}}),H=t(89);const J=(0,H.Z)(Z,[["__scopeId","data-v-19b988bc"]]);var P=J;const A={class:"calendar-list"};var K=(0,l.aZ)({__name:"CalendarGridComponent",setup(e){const{transactionsMonthFilter:a,transactionsYearFilter:t}=(0,u.Jk)((0,o.C)()),n=["Su","Mo","Tu","We","Th","Fr","Sa"],i=(0,l.Fl)((()=>new Date(t.value,a.value+1,0).getDate())),d=(0,l.Fl)((()=>{const e=[];let l=1;for(let r=1;r<=i.value;r++){const i={id:0,week:0,day:0,month:0,weekday:0,weekdayName:"",year:0};i.day=r,i.month=a.value,i.year=t.value,i.weekday=new Date(t.value,a.value,r).getDay(),i.weekdayName=n[i.weekday],i.week=l,i.id=new Date(i.year,i.month,i.day).getTime(),e.push(i),0===i.weekday&&l++}return e}));return(e,a)=>((0,l.wg)(),(0,l.iD)("ul",A,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.value,(e=>((0,l.wg)(),(0,l.iD)("li",{key:e.id,style:(0,r.j5)({"grid-area":e.weekdayName,"grid-row":e.week}),class:"calendar-list__item"},[(0,l.Wm)(P,{day:e},null,8,["day"])],4)))),128))]))}});const W=(0,H.Z)(K,[["__scopeId","data-v-717b28f5"]]);var q=W,B=t(5632),L=t(6838);const V=(0,l._)("div",{class:"container"},[(0,l._)("h3",null,"Календарь")],-1),E=(0,l._)("hr",null,null,-1),G={class:"row"},j={class:"col s12 m2 offset-m7"},$={class:"col s12 m3"},O={class:"row table-scrollable"};var Q=(0,l.aZ)({__name:"CalendarView",setup(e){return(e,a)=>((0,l.wg)(),(0,l.iD)(l.HY,null,[V,E,(0,l._)("div",G,[(0,l._)("div",j,[(0,l.Wm)(L.Z)]),(0,l._)("div",$,[(0,l.Wm)(B.Z,{"show-all":!1})])]),(0,l._)("div",O,[(0,l.Wm)(q)])],64))}});const R=Q;var X=R}}]);
//# sourceMappingURL=685.4e212e96.js.map