(function(){var e={6744:function(e,a,t){"use strict";var n=t(6504),l=t(5130),o=t(6768),c=t(144),s=t(4232),r=t(7760),u=t(9428),i=t(4574);const d=e=>((0,o.Qi)("data-v-7be3bf0b"),e=e(),(0,o.jt)(),e),v={class:"modal-content"},m=d((()=>(0,o.Lk)("h4",null,"Добавление нового счёта",-1))),b=d((()=>(0,o.Lk)("p",null,"Добавьте новый счёт для Вашей базы. Он понадобиться Вам для создания операция дохода и расхода.",-1))),p=d((()=>(0,o.Lk)("p",null,"Введите название Вашего нового счёта.",-1))),f=d((()=>(0,o.Lk)("button",{class:"btn modal-close-btn modal-close red"},[(0,o.Lk)("i",{class:"large material-icons"},"close")],-1))),y={class:"mc-form-category"},k={class:"row"},g={class:"input-field col s12"},h=d((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"mode_edit",-1))),L=d((()=>(0,o.Lk)("label",{for:"accountNameNew"},"Название нового счёта",-1))),w={key:0,class:"helper-text red-text"},R={key:1,class:"helper-text red-text"},A={class:"row"},$={class:"input-field col s12 m6"},_=d((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"currency_ruble",-1))),x=d((()=>(0,o.Lk)("label",{for:"amount"},"Баланс счёта",-1))),C={class:"col s12 m6"},E=d((()=>(0,o.Lk)("span",null,"Учитывать в общем балансе",-1))),N=d((()=>(0,o.Lk)("i",{class:"material-icons right"},"add_circle_outline",-1)));var F=(0,o.pM)({__name:"AddAccountComponent",setup(e){const a=(0,c.KR)(null),t=(0,c.KR)(),{pushNewAccount:n}=(0,i.l)(),d=(0,c.KR)(2),F=(0,c.Kh)({accountName:"",balance:0,isCountable:!0}),I={accountName:{required:u._$.withMessage("Поле НАЗВАНИЕ СЧЁТА является обязательным.",u.mw),minLength:u._$.withMessage((({$params:e})=>`Длина названия счёта должна быть не менее, чем ${e.min} символа.`),(0,u.Bp)(d))}},K=(0,r.fG)(I,F),D=(0,o.EW)((()=>K.value.accountName.$dirty&&K.value.accountName.required.$invalid)),T=(0,o.EW)((()=>K.value.accountName.$dirty&&K.value.accountName.minLength.$invalid)),P=async()=>{if(K.value.$invalid)return void K.value.$touch();const e={accountName:F.accountName,balance:Number(F.balance.toFixed(2)),isCountable:F.isCountable};try{await n(e)}catch(a){}finally{F.accountName="",F.balance=0,F.isCountable=!0,t.value.close()}};return(0,o.sV)((()=>{t.value=M.Modal.init(a.value)})),(0,o.xo)((()=>{t.value.destroy()})),(e,t)=>((0,o.uX)(),(0,o.CE)("div",{id:"modalAddAccount",ref_key:"addAccountModal",ref:a,class:"modal"},[(0,o.Lk)("div",v,[m,b,p,f,(0,o.Lk)("form",y,[(0,o.Lk)("div",k,[(0,o.Lk)("div",g,[h,(0,o.bo)((0,o.Lk)("input",{id:"accountNameNew","onUpdate:modelValue":t[0]||(t[0]=e=>F.accountName=e),class:(0,s.C4)({invalid:D.value||T.value}),type:"text"},null,2),[[l.Jo,F.accountName,void 0,{trim:!0}]]),L,D.value?((0,o.uX)(),(0,o.CE)("small",w,(0,s.v_)((0,c.R1)(K).accountName.required.$message),1)):T.value?((0,o.uX)(),(0,o.CE)("small",R,(0,s.v_)((0,c.R1)(K).accountName.minLength.$message),1)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",A,[(0,o.Lk)("div",$,[_,(0,o.bo)((0,o.Lk)("input",{id:"amount","onUpdate:modelValue":t[1]||(t[1]=e=>F.balance=e),step:"0.01",type:"number"},null,512),[[l.Jo,F.balance,void 0,{number:!0}]]),x]),(0,o.Lk)("div",C,[(0,o.Lk)("label",null,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>F.isCountable=e),class:"filled-in",type:"checkbox"},null,512),[[l.lH,F.isCountable]]),E])])]),(0,o.Lk)("button",{class:"mc-button-submit btn",name:"action",type:"submit",onClick:(0,l.D$)(P,["prevent"])},[(0,o.eW)("Добавить "),N])])])],512))}}),I=t(1241);const K=(0,I.A)(F,[["__scopeId","data-v-7be3bf0b"]]);var D=K,T=t(6995),P=t(6459),W=t(3367);const X=e=>((0,o.Qi)("data-v-c69e2fc4"),e=e(),(0,o.jt)(),e),S={class:"modal-content"},U=X((()=>(0,o.Lk)("h4",null,"Удаление счёта:",-1))),V={key:0,class:"red-text"},j={key:1},B=X((()=>(0,o.Lk)("li",null,"Операции по этому счёту:",-1))),J=X((()=>(0,o.Lk)("p",null,"Для удаления счёт введите его название в поле ниже.",-1))),O=X((()=>(0,o.Lk)("button",{class:"btn modal-close-btn modal-close"},[(0,o.Lk)("i",{class:"large material-icons"},"close")],-1))),q={class:"mc-form-category"},G={class:"row"},Y={class:"input-field col s12"},Q=X((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"mode_edit",-1))),Z=X((()=>(0,o.Lk)("label",{for:"deleteAccountNameField"},"Название нового счёта",-1))),H={key:0,class:"helper-text red-text"},z=["disabled"],ee=X((()=>(0,o.Lk)("i",{class:"material-icons right"},"delete_forever",-1)));var ae=(0,o.pM)({__name:"DeleteAccountComponent",setup(e){const a=(0,c.KR)(!1),t=(0,c.KR)(null),n=(0,c.KR)(),{deleteAccount:d}=(0,i.l)(),{selectedAccountId:v,selectedAccountName:m}=(0,W.bP)((0,i.l)()),{transactionsSortedByDate:b}=(0,W.bP)((0,T.G)()),{currencyFilter:p,dateFilter:f}=(0,P.c)(),y=(0,o.EW)((()=>b.value.filter((e=>e.accountId===v.value)))),k=()=>{a.value=h.deleteAccount===m.value},g=()=>{d(),n.value.close()},h=(0,c.Kh)({deleteAccount:""}),L={deleteAccount:{required:u._$.withMessage("Для удаления необходимо ввести НАИМЕНОВАНИЕ удаляемого счёта",u.mw)}},w=(0,r.fG)(L,h),R=(0,o.EW)((()=>w.value.deleteAccount.$dirty&&w.value.deleteAccount.required.$invalid));return(0,o.sV)((()=>{n.value=M.Modal.init(t.value)})),(0,o.xo)((()=>{n.value.destroy()})),(e,n)=>((0,o.uX)(),(0,o.CE)("div",{id:"modalDeleteAccount",ref_key:"deleteAccountModal",ref:t,class:"modal"},[(0,o.Lk)("div",S,[U,(0,o.Lk)("h4",null,(0,s.v_)((0,c.R1)(m)),1),(0,o.Lk)("h6",{class:(0,s.C4)({"red-text":y.value.length>0})},"Вы действительно хотите удалить этот счёт?",2),y.value.length>5?((0,o.uX)(),(0,o.CE)("h6",V,"С этим счётом связано "+(0,s.v_)(y.value.length)+" операций! ",1)):y.value.length>0?((0,o.uX)(),(0,o.CE)("ul",j,[B,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(y.value,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e.id},(0,s.v_)((0,c.R1)(f)(e.date))+" - "+(0,s.v_)((0,c.R1)(p)(e.amount)),1)))),128))])):(0,o.Q3)("",!0),J,O,(0,o.Lk)("form",q,[(0,o.Lk)("div",G,[(0,o.Lk)("div",Y,[Q,(0,o.bo)((0,o.Lk)("input",{id:"deleteAccountNameField","onUpdate:modelValue":n[0]||(n[0]=e=>h.deleteAccount=e),class:(0,s.C4)({invalid:R.value}),type:"text",onInput:k},null,34),[[l.Jo,h.deleteAccount,void 0,{trim:!0}]]),Z,R.value?((0,o.uX)(),(0,o.CE)("small",H,(0,s.v_)((0,c.R1)(w).deleteAccount.required.$message),1)):(0,o.Q3)("",!0)])]),(0,o.Lk)("button",{disabled:!a.value,class:"mc-button-submit btn red",name:"action",type:"submit",onClick:(0,l.D$)(g,["prevent"])},[(0,o.eW)("Удалить счет "),ee],8,z)])])],512))}});const te=(0,I.A)(ae,[["__scopeId","data-v-c69e2fc4"]]);var ne=te;const le=e=>((0,o.Qi)("data-v-741e10aa"),e=e(),(0,o.jt)(),e),oe={class:"modal-content"},ce=le((()=>(0,o.Lk)("p",null,"Тут Вы можете изменить наименование Вашего счёта",-1))),se=le((()=>(0,o.Lk)("p",null,"Введите новое наименование Вашего счёта.",-1))),re=le((()=>(0,o.Lk)("button",{class:"btn modal-close-btn modal-close"},[(0,o.Lk)("i",{class:"large material-icons"},"close")],-1))),ue={class:"mc-form-category"},ie={class:"row"},de={class:"input-field col s12"},ve=le((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"mode_edit",-1))),me=le((()=>(0,o.Lk)("label",{for:"accountNameEdit"},"Новое наименование счёта",-1))),be={key:0,class:"helper-text red-text"},pe={key:1,class:"helper-text red-text"},fe={class:"row"},ye={class:"input-field col s12"},ke=le((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"currency_ruble",-1))),ge=le((()=>(0,o.Lk)("label",{for:"amount"},"Сумма",-1))),he={class:"col s12 m6"},Le=le((()=>(0,o.Lk)("span",null,"Учитывать в общем балансе",-1))),we=le((()=>(0,o.Lk)("i",{class:"material-icons right"},"publish",-1)));var Re=(0,o.pM)({__name:"EditAccountComponent",setup(e){const a=(0,c.KR)(null),t=(0,c.KR)(),{selectedAccountName:n,selectedAccountBalance:d}=(0,W.bP)((0,i.l)()),{changeAccount:v}=(0,i.l)(),m=(0,c.KR)(2),b=(0,c.Kh)({accountName:"",balance:0,isCountable:!0}),p={accountName:{required:u._$.withMessage("Поле НАЗВАНИЕ СЧЁТА является обязательным.",u.mw),minLength:u._$.withMessage((({$params:e})=>`Длина названия счёта должна быть не менее, чем ${e.min} символа.`),(0,u.Bp)(m))}},f=(0,r.fG)(p,b),y=(0,o.EW)((()=>f.value.accountName.$dirty&&f.value.accountName.required.$invalid)),k=(0,o.EW)((()=>f.value.accountName.$dirty&&f.value.accountName.minLength.$invalid)),g=async()=>{if(f.value.$invalid)return void f.value.$touch();const e={accountName:b.accountName,balance:Number(b.balance.toFixed(2)),isCountable:b.isCountable};try{await v(e)}catch(a){console.error(a)}finally{b.accountName="",t.value.close()}},h={onOpenStart:()=>{b.accountName=n.value,b.balance=d.value},onOpenEnd:()=>M.updateTextFields()};return(0,o.sV)((()=>{t.value=M.Modal.init(a.value,h)})),(0,o.xo)((()=>{t.value.destroy()})),(e,t)=>((0,o.uX)(),(0,o.CE)("div",{id:"modalEditAccount",ref_key:"editAccountModal",ref:a,class:"modal"},[(0,o.Lk)("div",oe,[(0,o.Lk)("h4",null,[(0,o.eW)("Изменение счёта "),(0,o.Lk)("strong",null,(0,s.v_)((0,c.R1)(n)),1)]),ce,se,re,(0,o.Lk)("form",ue,[(0,o.Lk)("div",ie,[(0,o.Lk)("div",de,[ve,(0,o.bo)((0,o.Lk)("input",{id:"accountNameEdit","onUpdate:modelValue":t[0]||(t[0]=e=>b.accountName=e),class:(0,s.C4)({invalid:y.value||k.value}),type:"text"},null,2),[[l.Jo,b.accountName,void 0,{trim:!0}]]),me,y.value?((0,o.uX)(),(0,o.CE)("small",be,(0,s.v_)((0,c.R1)(f).accountName.required.$message),1)):k.value?((0,o.uX)(),(0,o.CE)("small",pe,(0,s.v_)((0,c.R1)(f).accountName.minLength.$message),1)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",fe,[(0,o.Lk)("div",ye,[ke,(0,o.bo)((0,o.Lk)("input",{id:"amount","onUpdate:modelValue":t[1]||(t[1]=e=>b.balance=e),step:"0.01",type:"number"},null,512),[[l.Jo,b.balance,void 0,{number:!0}]]),ge]),(0,o.Lk)("div",he,[(0,o.Lk)("label",null,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>b.isCountable=e),class:"filled-in",type:"checkbox"},null,512),[[l.lH,b.isCountable]]),Le])])]),(0,o.Lk)("button",{class:"mc-button-submit btn",name:"action",type:"submit",onClick:(0,l.D$)(g,["prevent"])},[(0,o.eW)("Изменить "),we])])])],512))}});const Ae=(0,I.A)(Re,[["__scopeId","data-v-741e10aa"]]);var $e=Ae,_e=t(5741),xe=t.n(_e),Ce=t(8078);const{getNewDate:Ee}=(0,T.G)(n.A),Ne={format:"d mmmm yyyy",autoClose:!0,defaultDate:new Date,firstDay:1,i18n:{cancel:"Отмена",clear:"Очистить",done:"Выбрать",months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],weekdays:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],weekdaysShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekdaysAbbrev:["В","П","Вт","С","Ч","Пт","Сб"]},onSelect:Ee},Fe=e=>((0,o.Qi)("data-v-3fe50110"),e=e(),(0,o.jt)(),e),Ie=Fe((()=>(0,o.Lk)("h4",{class:"center-align"},"Добавление новой записи",-1))),Ke=Fe((()=>(0,o.Lk)("button",{class:"btn modal-close-btn modal-close red"},[(0,o.Lk)("i",{class:"large material-icons"},"close")],-1))),De={class:"row"},Te={class:"row"},Pe={class:"input-field col s12"},We=["value"],Me=Fe((()=>(0,o.Lk)("label",null,"Счёт",-1))),Xe={class:"row"},Se={class:"input-field col s12"},Ue=["value"],Ve=Fe((()=>(0,o.Lk)("label",null,"Категория",-1))),je={class:"row"},Be={class:"input-field col s12"},Je=Fe((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"calendar_month",-1))),Oe=Fe((()=>(0,o.Lk)("label",{for:"recordDate"},"Дата",-1))),qe={class:"row"},Ge={class:"input-field col s12"},Ye=Fe((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"currency_ruble",-1))),Qe=Fe((()=>(0,o.Lk)("label",{for:"amount"},"Сумма",-1))),Ze={key:0,class:"helper-text red-text"},He={key:1,class:"helper-text red-text"},ze={class:"row"},ea={class:"input-field col s12"},aa=Fe((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"edit",-1))),ta=Fe((()=>(0,o.Lk)("label",{for:"description"},"Комментарий",-1))),na={class:"row valign-wrapper"},la={class:"col s12 m4"},oa=["disabled"],ca=Fe((()=>(0,o.Lk)("i",{class:"material-icons right"},"add",-1))),sa={class:"col s12 m8"},ra=["disabled"],ua=Fe((()=>(0,o.Lk)("span",{class:"red-text"},"Незапланированный расход?",-1)));var ia=(0,o.pM)({__name:"AddRecordComponent",setup(e){const{pushNewTransaction:a}=(0,T.G)(),{transactionDate:t}=(0,W.bP)((0,T.G)()),{accounts:n,selectedAccountId:d,selectedAccountName:v}=(0,W.bP)((0,i.l)()),{categories:m,selectedCategoryId:b,selectedCategory:p}=(0,W.bP)((0,Ce.d)()),{currencyFilter:f}=(0,P.c)(),y=(0,c.KR)(),k=(0,c.KR)(null),g=(0,c.KR)(),h=(0,c.KR)(),L=(0,c.KR)(),w=(0,c.KR)(.01),R=(0,c.Kh)({transactionAmount:0,transactionDescription:"",isNotPlanned:!1}),A={transactionAmount:{required:u._$.withMessage("Поле СУММА является обязательным.",u.mw),minValue:u._$.withMessage((({$params:e})=>`Сумма должна быть не менее, чем ${e.min} рублей.`),(0,u.Ww)(w))}},$=(0,r.fG)(A,R),_=(0,o.EW)((()=>$.value.transactionAmount.$dirty&&$.value.transactionAmount.required.$invalid)),x=(0,o.EW)((()=>$.value.transactionAmount.$dirty&&$.value.transactionAmount.minValue.$invalid)),C=(0,o.EW)((()=>!(!p.value||!v||$.value.transactionAmount.$invalid))),E=async()=>{if($.value.$invalid)return void $.value.$touch();const e={category:p.value?.name,categoryId:b.value,account:v.value,accountId:d.value,type:p.value?.type,amount:Number(R.transactionAmount.toFixed(2)),description:R.transactionDescription,date:t.value,isNotPlanned:R.isNotPlanned,readonly:!1};try{await a(e)}catch(n){console.error(n)}finally{R.transactionDescription="",R.transactionAmount=0,R.isNotPlanned=!1,d.value="",b.value="",g.value.close()}};return(0,o.$u)((()=>{y.value=document.querySelectorAll("select"),xe().FormSelect.init(y.value),xe().updateTextFields()})),(0,o.sV)((()=>{g.value=xe().Modal.init(k.value),xe().FormSelect.init(y.value),xe().updateTextFields(),L.value=xe().Datepicker.init(h.value,Ne)})),(0,o.xo)((()=>{g.value.destroy(),L.value.destroy()})),(e,a)=>((0,o.uX)(),(0,o.CE)("div",{id:"modalAddTransaction",ref_key:"addTransactionModal",ref:k,class:"modal p-24"},[Ie,Ke,(0,o.Lk)("div",De,[(0,o.Lk)("form",{class:"col s12",onSubmit:(0,l.D$)(E,["prevent"])},[(0,o.Lk)("div",Te,[(0,o.Lk)("div",Pe,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>(0,c.i9)(d)?d.value=e:null)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,c.R1)(n),(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,s.v_)(e.name)+" | "+(0,s.v_)((0,c.R1)(f)(e["balance"])),9,We)))),128))],512),[[l.u1,(0,c.R1)(d)]]),Me])]),(0,o.Lk)("div",Xe,[(0,o.Lk)("div",Se,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>(0,c.i9)(b)?b.value=e:null)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,c.R1)(m),(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,s.v_)(e.name)+" | "+(0,s.v_)("outcome"===e.type?"Расход":"Доход"),9,Ue)))),128))],512),[[l.u1,(0,c.R1)(b)]]),Ve])]),(0,o.Lk)("div",je,[(0,o.Lk)("div",Be,[Je,(0,o.Lk)("input",{id:"recordDate",ref_key:"datepicker",ref:h,class:"datepicker",name:"recordDate",type:"text"},null,512),Oe])]),(0,o.Lk)("div",qe,[(0,o.Lk)("div",Ge,[Ye,(0,o.bo)((0,o.Lk)("input",{id:"amount","onUpdate:modelValue":a[2]||(a[2]=e=>R.transactionAmount=e),class:(0,s.C4)({invalid:_.value||x.value}),step:"0.01",type:"number"},null,2),[[l.Jo,R.transactionAmount,void 0,{number:!0}]]),Qe,_.value?((0,o.uX)(),(0,o.CE)("small",Ze,(0,s.v_)((0,c.R1)($).transactionAmount.required.$message),1)):x.value?((0,o.uX)(),(0,o.CE)("small",He,(0,s.v_)((0,c.R1)($).transactionAmount.minValue.$message),1)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",ze,[(0,o.Lk)("div",ea,[aa,(0,o.bo)((0,o.Lk)("input",{id:"description","onUpdate:modelValue":a[3]||(a[3]=e=>R.transactionDescription=e),type:"text"},null,512),[[l.Jo,R.transactionDescription]]),ta])]),(0,o.Lk)("div",na,[(0,o.Lk)("div",la,[(0,o.Lk)("button",{disabled:!C.value,class:"mc-button-submit btn light-green darken-4",name:"action",type:"submit"},[(0,o.eW)(" Добавить "),ca],8,oa)]),(0,o.Lk)("div",sa,[(0,o.Lk)("label",null,[(0,o.bo)((0,o.Lk)("input",{disabled:"income"===(0,c.R1)(p)?.type,"onUpdate:modelValue":a[4]||(a[4]=e=>R.isNotPlanned=e),class:"filled-in",type:"checkbox"},null,8,ra),[[l.lH,R.isNotPlanned]]),ua])])])],32)])],512))}});const da=(0,I.A)(ia,[["__scopeId","data-v-3fe50110"]]);var va=da;const ma=e=>((0,o.Qi)("data-v-9c53af5c"),e=e(),(0,o.jt)(),e),ba={class:"modal-content"},pa=ma((()=>(0,o.Lk)("h4",null,"Перевод средств со счёта на счёт",-1))),fa=ma((()=>(0,o.Lk)("button",{class:"btn modal-close-btn modal-close red"},[(0,o.Lk)("i",{class:"large material-icons"},"close")],-1))),ya={class:"mc-form-category"},ka={class:"row"},ga={class:"input-field col s12"},ha=["value"],La=ma((()=>(0,o.Lk)("label",null,"Выберите счёт-отправитель",-1))),wa={class:"row"},Ra={class:"input-field col s12"},Aa=["value"],$a=ma((()=>(0,o.Lk)("label",null,"Выберите счёт-получатель",-1))),_a={class:"row"},xa={class:"input-field col s12"},Ca=ma((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"calendar_month",-1))),Ea=ma((()=>(0,o.Lk)("label",{for:"transferDate"},"Дата",-1))),Na={class:"row"},Fa={class:"input-field col s12"},Ia=ma((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"currency_ruble",-1))),Ka=ma((()=>(0,o.Lk)("label",{for:"amount"},"Сумма перевода",-1))),Da={class:"row"},Ta={class:"col"},Pa={key:0,class:"red-text"},Wa={key:1,class:"red-text"},Ma={key:2,class:"red-text"},Xa={key:3,class:"red-text"},Sa={class:"row"},Ua={class:"col"},Va=["disabled"],ja=ma((()=>(0,o.Lk)("i",{class:"material-icons right"},"forward",-1)));var Ba=(0,o.pM)({__name:"AccountsTransferComponent",setup(e){const{accounts:a,selectedAccountId:t,selectedAccountName:n,destinationAccountId:r,destinationAccountName:u,transferAmount:d,requiredAmountForTransfer:v,isSourceAccountBalanceNotEnough:m}=(0,W.bP)((0,i.l)()),{pushNewTransaction:b}=(0,T.G)(),{transactionDate:p}=(0,W.bP)((0,T.G)()),{currencyFilter:f}=(0,P.c)(),y=(0,c.KR)(),k=(0,c.KR)(),g=(0,c.KR)(),h=(0,c.KR)(),L=(0,c.KR)(),w=(0,o.EW)((()=>t.value===r.value||!t.value||!r.value)),R=(0,o.EW)((()=>w.value||m.value||d.value<=0)),A=async()=>{if(R.value)return;const e={account:n.value,accountId:t.value,amount:d.value,category:u.value,categoryId:r.value,date:p.value,description:`Перевод из ${n.value} на ${u.value}`,type:"transfer",isNotPlanned:!1,readonly:!1};await b(e),k.value.close()};return(0,o.sV)((()=>{k.value=xe().Modal.init(y.value),g.value=document.querySelectorAll("select"),xe().FormSelect.init(g.value),xe().updateTextFields(),L.value=xe().Datepicker.init(h.value,Ne)})),(0,o.xo)((()=>{k.value.destroy()})),(e,n)=>((0,o.uX)(),(0,o.CE)("div",{id:"modalTransferBetweenAccounts",ref_key:"modalTransfer",ref:y,class:"modal"},[(0,o.Lk)("div",ba,[pa,fa,(0,o.Lk)("form",ya,[(0,o.Lk)("div",ka,[(0,o.Lk)("div",ga,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":n[0]||(n[0]=e=>(0,c.i9)(t)?t.value=e:null)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,c.R1)(a),(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,s.v_)(e.name)+" | "+(0,s.v_)((0,c.R1)(f)(e.balance)),9,ha)))),128))],512),[[l.u1,(0,c.R1)(t)]]),La])]),(0,o.Lk)("div",wa,[(0,o.Lk)("div",Ra,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":n[1]||(n[1]=e=>(0,c.i9)(r)?r.value=e:null)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,c.R1)(a),(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,s.v_)(e.name)+" | "+(0,s.v_)((0,c.R1)(f)(e.balance)),9,Aa)))),128))],512),[[l.u1,(0,c.R1)(r)]]),$a])]),(0,o.Lk)("div",_a,[(0,o.Lk)("div",xa,[Ca,(0,o.Lk)("input",{id:"transferDate",ref_key:"datepicker",ref:h,class:"datepicker",name:"transferDate",type:"text"},null,512),Ea])]),(0,o.Lk)("div",Na,[(0,o.Lk)("div",Fa,[Ia,(0,o.bo)((0,o.Lk)("input",{id:"amount","onUpdate:modelValue":n[2]||(n[2]=e=>(0,c.i9)(d)?d.value=e:null),step:"0.01",type:"number"},null,512),[[l.Jo,(0,c.R1)(d)]]),Ka])]),(0,o.Lk)("div",Da,[(0,o.Lk)("div",Ta,[(0,c.R1)(t)?(0,c.R1)(r)?w.value?((0,o.uX)(),(0,o.CE)("small",Ma," Счёт-отправитель и счёт-получатель должны быть разными ")):(0,c.R1)(m)?((0,o.uX)(),(0,o.CE)("small",Xa,[(0,o.eW)(" На счете-отправителе не хватает "),(0,o.Lk)("strong",null,(0,s.v_)((0,c.R1)(f)((0,c.R1)(v).toString())),1)])):(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("small",Wa," Необходимо выбрать счёт-получатель ")):((0,o.uX)(),(0,o.CE)("small",Pa," Необходимо выбрать счёт-отправитель "))])]),(0,o.Lk)("div",Sa,[(0,o.Lk)("div",Ua,[(0,o.Lk)("button",{disabled:R.value,class:"mc-button-submit btn blue",name:"action",type:"submit",onClick:(0,l.D$)(A,["prevent"])},[(0,o.eW)("Перевести "),ja],8,Va)])])])])],512))}});const Ja=(0,I.A)(Ba,[["__scopeId","data-v-9c53af5c"]]);var Oa=Ja,qa=t(5254),Ga=(t(4114),t(2132));const Ya=(0,W.nY)("advisor",(()=>{const{isAdvisorReadyToStart:e}=(0,W.bP)((0,Ga.X)(n.A)),{categories:a}=(0,W.bP)((0,Ce.d)(n.A)),{transactions:t}=(0,W.bP)((0,T.G)(n.A)),{limits:l}=(0,W.bP)((0,qa.A)(n.A)),c=[0,1,2,3,4,5,6,7,8,9,10,11],s=(0,o.EW)((()=>{const e=new Set;return t.value.filter((e=>new Date(e.date).getFullYear()<=(new Date).getFullYear())).forEach((a=>{e.add(new Date(a.date).getFullYear())})),Array.from(e)}));function r(e){if(!e)return console.warn("В функцию getMedian не передан массив чисел для обработки"),0;if(0===e.length)return console.warn("В функцию getMedian передан пустой массив"),0;if(1===e.length)return e[0];const a=e.sort(((e,a)=>e-a)),t=a.length;if(t%2===0){const e=a[t/2],n=a[t/2-1];return(e+n)/2}return a[(t-1)/2]}const u=(0,o.EW)((()=>e.value?a.value.map((e=>{const a=t.value.filter((a=>a.categoryId===e.id)),n=l.value.filter((a=>a.categoryId===e.id)),o=[],u=[];let i=!1;0===s.value.length?console.log("Получаем все годы в транзакциях..."):s.value.forEach((e=>{const t=a.filter((a=>e===new Date(a.date).getFullYear())),n=t.reduce(((e,a)=>Number((e+=+a.amount).toFixed(2))),0);o.push({year:e,amount:n}),c.forEach((a=>{if(e===(new Date).getFullYear()&&a>(new Date).getMonth())return;const n=t.filter((e=>a===new Date(e.date).getMonth()));if(!i&&n.length>0&&(i=!0),i){const t=n.reduce(((e,a)=>Number((e+=+a.amount).toFixed(2))),0);u.push({year:e,month:a,amount:t})}}))}));const d=u.map((e=>e.amount)),v=r(d),m=d.reduce(((e,a)=>Number((e+=+a).toFixed(2))),0)/d.length;return{...e,records:a,plans:n,yearsAndSums:o,periodsAndSums:u,median:v,average:m}})):[]));return{extendedCategories:u}})),Qa=e=>((0,o.Qi)("data-v-4d086926"),e=e(),(0,o.jt)(),e),Za={class:"modal-content"},Ha=Qa((()=>(0,o.Lk)("h4",null,"Установка лимита",-1))),za=Qa((()=>(0,o.Lk)("button",{class:"btn modal-close-btn modal-close red"},[(0,o.Lk)("i",{class:"large material-icons"},"close")],-1))),et={class:"row"},at={class:"col s12"},tt={class:"input-field col s12"},nt=["value"],lt=Qa((()=>(0,o.Lk)("label",null,"На какую категорию установить лимит?",-1))),ot={class:"row"},ct={class:"input-field col s12"},st=Qa((()=>(0,o.Lk)("label",{for:"limitAmount"},"Сумма лимита (введите 0, чтобы убрать лимит)",-1))),rt={class:"row"},ut={class:"col"},it={key:0},dt={class:"green-text"},vt={key:1},mt=Qa((()=>(0,o.Lk)("h3",{class:"deep-orange-text"},"На эту категорию лимит не установлен",-1))),bt=Qa((()=>(0,o.Lk)("div",{class:"row"},[(0,o.Lk)("div",{class:"col"},[(0,o.Lk)("button",{class:"mc-button-submit btn",name:"action",type:"submit"},[(0,o.eW)(" Установить лимит "),(0,o.Lk)("i",{class:"material-icons right"},"upload")])])],-1)));var pt=(0,o.pM)({__name:"SetLimitToCategory",setup(e){const a=(0,c.KR)(),t=(0,c.KR)(),{selectedCategoryId:n,selectedCategory:r,categoriesAvailableForLimitation:u}=(0,W.bP)((0,Ce.d)()),{transactionsYearFilter:i,transactionsMonthFilter:d}=(0,W.bP)((0,T.G)()),{limitsYearMonth:v,setLimitValue:m}=(0,W.bP)((0,qa.A)()),{extendedCategories:b}=(0,W.bP)(Ya()),{pushNewLimit:p}=(0,qa.A)(),{currencyFilter:f}=(0,P.c)(),y=(0,o.EW)((()=>{const e=v.value.find((e=>e.categoryId===n.value));return void 0!==e&&n.value?e.limit:0})),k=(0,o.EW)((()=>{if(!n.value)return 0;const e=b.value.find((e=>e.id===n.value));return e?e.median:0})),g=(0,o.EW)((()=>{if(!n.value)return 0;const e=b.value.find((e=>e.id===n.value));return e?e.average:0})),h=async()=>{const e={month:d.value,year:i.value,categoryId:n.value,limit:m.value,id:""};try{await p(e)}catch(a){console.log(a)}finally{n.value="",m.value=0,t.value.close()}};return(0,o.sV)((()=>{t.value=xe().Modal.init(a.value,{onCloseStart(){n.value=""}}),xe().updateTextFields()})),(0,o.xo)((()=>{t.value.destroy()})),(e,t)=>((0,o.uX)(),(0,o.CE)("div",{id:"modalSetLimit",ref_key:"setLimitModal",ref:a,class:"modal"},[(0,o.Lk)("div",Za,[Ha,za,(0,o.Lk)("form",{class:"mc-form-category",onSubmit:(0,l.D$)(h,["prevent"])},[(0,o.Lk)("div",et,[(0,o.Lk)("div",at,[(0,o.Lk)("div",tt,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>(0,c.i9)(n)?n.value=e:null)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,c.R1)(u),(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,s.v_)(e.name),9,nt)))),128))],512),[[l.u1,(0,c.R1)(n)]]),lt])])]),(0,o.Lk)("div",ot,[(0,o.Lk)("div",ct,[(0,o.bo)((0,o.Lk)("input",{id:"limitAmount","onUpdate:modelValue":t[1]||(t[1]=e=>(0,c.i9)(m)?m.value=e:null),type:"number"},null,512),[[l.Jo,(0,c.R1)(m),void 0,{number:!0}]]),st])]),(0,o.Lk)("div",rt,[(0,o.Lk)("div",ut,[(0,c.R1)(n)&&y.value>0?((0,o.uX)(),(0,o.CE)("blockquote",it,[(0,o.Lk)("h3",dt,"Сумма лимита в этом месяце "+(0,s.v_)((0,c.R1)(f)(y.value)),1),(0,o.Lk)("h5",null,[(0,o.eW)("В среднем наши расходы в категории "),(0,o.Lk)("strong",null,(0,s.v_)((0,c.R1)(r).name),1),(0,o.eW)(" составялют "),(0,o.Lk)("strong",null,(0,s.v_)((0,c.R1)(f)(g.value)),1)]),(0,o.Lk)("h5",null,[(0,o.eW)("Чаще всего тут мы тратим до "),(0,o.Lk)("strong",null,(0,s.v_)((0,c.R1)(f)(k.value)),1)])])):""!==(0,c.R1)(n)?((0,o.uX)(),(0,o.CE)("blockquote",vt,[mt,(0,o.Lk)("h5",null,[(0,o.eW)("В среднем наши расходы в категории "),(0,o.Lk)("strong",null,(0,s.v_)((0,c.R1)(r).name),1),(0,o.eW)(" составялют "),(0,o.Lk)("strong",null,(0,s.v_)((0,c.R1)(f)(g.value)),1)]),(0,o.Lk)("h5",null,[(0,o.eW)("Чаще всего тут мы тратим до "),(0,o.Lk)("strong",null,(0,s.v_)((0,c.R1)(f)(k.value)),1)])])):(0,o.Q3)("",!0)])]),bt],32)])],512))}});const ft=(0,I.A)(pt,[["__scopeId","data-v-4d086926"]]);var yt=ft;const kt=e=>((0,o.Qi)("data-v-9694da70"),e=e(),(0,o.jt)(),e),gt={class:"modal-content"},ht=kt((()=>(0,o.Lk)("h4",null,"Изменить данные",-1))),Lt=kt((()=>(0,o.Lk)("button",{class:"btn modal-close-btn modal-close red"},[(0,o.Lk)("i",{class:"large material-icons"},"close")],-1))),wt={class:"row"},Rt={class:"row"},At={class:"input-field col s12"},$t=["value"],_t=kt((()=>(0,o.Lk)("label",null,"Счёт",-1))),xt={class:"row"},Ct={class:"input-field col s12"},Et=["value"],Nt=kt((()=>(0,o.Lk)("label",null,"Категория",-1))),Ft={class:"row"},It={class:"input-field col s12"},Kt=kt((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"calendar_month",-1))),Dt=kt((()=>(0,o.Lk)("label",{for:"recordDateEdit"},"Дата",-1))),Tt={class:"row"},Pt={class:"input-field col s12"},Wt=kt((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"currency_ruble",-1))),Mt=kt((()=>(0,o.Lk)("label",{for:"amount"},"Сумма",-1))),Xt={key:0,class:"helper-text red-text"},St={key:1,class:"helper-text red-text"},Ut={class:"row"},Vt={class:"input-field col s12"},jt=kt((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"edit",-1))),Bt=kt((()=>(0,o.Lk)("label",{for:"description"},"Комментарий",-1))),Jt={class:"row valign-wrapper"},Ot={class:"col s12 m4"},qt=["disabled"],Gt=kt((()=>(0,o.Lk)("i",{class:"material-icons right"},"upload",-1))),Yt={class:"col s12 m8"},Qt=kt((()=>(0,o.Lk)("span",{class:"red-text"},"Незапланированный расход?",-1)));var Zt=(0,o.pM)({__name:"EditTransactionComponent",setup(e){const{accounts:a,selectedAccountId:t,selectedAccountName:n}=(0,W.bP)((0,i.l)()),{categories:d,selectedCategoryId:v,selectedCategory:m}=(0,W.bP)((0,Ce.d)()),{selectedTransaction:b,transactionDate:p}=(0,W.bP)((0,T.G)()),{editTransaction:f}=(0,T.G)(),{currencyFilter:y}=(0,P.c)(),k=(0,c.KR)(),g=(0,c.KR)(),h=(0,c.KR)(),L=(0,c.KR)(),w=(0,c.KR)(),R=(0,c.KR)(.01),A=(0,c.Kh)({transactionAmount:0,transactionDescription:"",isNotPlanned:!1}),$={transactionAmount:{required:u._$.withMessage("Поле СУММА является обязательным.",u.mw),minValue:u._$.withMessage((({$params:e})=>`Сумма должна быть не менее, чем ${e.min} рублей.`),(0,u.Ww)(R))}},_=(0,r.fG)($,A),x=(0,o.EW)((()=>_.value.transactionAmount.$dirty&&_.value.transactionAmount.required.$invalid)),C=(0,o.EW)((()=>_.value.transactionAmount.$dirty&&_.value.transactionAmount.minValue.$invalid)),E=(0,o.EW)((()=>!(!m.value||!n||_.value.transactionAmount.$invalid))),N=async()=>{const e={account:n.value,accountId:t.value,amount:Number(A.transactionAmount.toFixed(2)),category:m.value?.name,categoryId:v.value,date:p.value,description:A.transactionDescription,isNotPlanned:A.isNotPlanned,type:m.value?.type};await f(e),g.value.close()},F={onOpenStart:()=>{t.value=b.value?.accountId,v.value=b.value?.categoryId,A.transactionAmount=b.value?.amount,A.transactionDescription=b.value?.description,A.isNotPlanned=b.value?.isNotPlanned},onOpenEnd:()=>{xe().updateTextFields()},onCloseEnd:()=>{t.value="",v.value=""}};return(0,o.$u)((()=>{w.value=document.querySelectorAll("select"),xe().FormSelect.init(w.value),xe().updateTextFields()})),(0,o.sV)((()=>{g.value=xe().Modal.init(k.value,F),xe().FormSelect.init(w.value),xe().updateTextFields(),L.value=xe().Datepicker.init(h.value,Ne)})),(0,o.xo)((()=>{g.value.destroy(),L.value.destroy()})),(e,n)=>((0,o.uX)(),(0,o.CE)("div",{id:"modalEditTransaction",ref_key:"editTransactionModal",ref:k,class:"modal"},[(0,o.Lk)("div",gt,[ht,Lt,(0,o.Lk)("div",wt,[(0,o.Lk)("form",{class:"col s12",onSubmit:(0,l.D$)(N,["prevent"])},[(0,o.Lk)("div",Rt,[(0,o.Lk)("div",At,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":n[0]||(n[0]=e=>(0,c.i9)(t)?t.value=e:null)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,c.R1)(a),(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,s.v_)(e.name)+" | "+(0,s.v_)((0,c.R1)(y)(e.balance)),9,$t)))),128))],512),[[l.u1,(0,c.R1)(t)]]),_t])]),(0,o.Lk)("div",xt,[(0,o.Lk)("div",Ct,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":n[1]||(n[1]=e=>(0,c.i9)(v)?v.value=e:null)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,c.R1)(d),(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,s.v_)(e.name)+" | "+(0,s.v_)("outcome"===e.type?"Расход":"Доход"),9,Et)))),128))],512),[[l.u1,(0,c.R1)(v)]]),Nt])]),(0,o.Lk)("div",Ft,[(0,o.Lk)("div",It,[Kt,(0,o.Lk)("input",{id:"recordDateEdit",ref_key:"datepicker",ref:h,class:"datepicker",name:"recordDateEdit",type:"text"},null,512),Dt])]),(0,o.Lk)("div",Tt,[(0,o.Lk)("div",Pt,[Wt,(0,o.bo)((0,o.Lk)("input",{id:"amount","onUpdate:modelValue":n[2]||(n[2]=e=>A.transactionAmount=e),class:(0,s.C4)({invalid:x.value||C.value}),step:"0.01",type:"number"},null,2),[[l.Jo,A.transactionAmount,void 0,{number:!0}]]),Mt,x.value?((0,o.uX)(),(0,o.CE)("small",Xt,(0,s.v_)((0,c.R1)(_).transactionAmount.required.$message),1)):C.value?((0,o.uX)(),(0,o.CE)("small",St,(0,s.v_)((0,c.R1)(_).transactionAmount.minValue.$message),1)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",Ut,[(0,o.Lk)("div",Vt,[jt,(0,o.bo)((0,o.Lk)("input",{id:"description","onUpdate:modelValue":n[3]||(n[3]=e=>A.transactionDescription=e),type:"text"},null,512),[[l.Jo,A.transactionDescription]]),Bt])]),(0,o.Lk)("div",Jt,[(0,o.Lk)("div",Ot,[(0,o.Lk)("button",{disabled:!E.value,class:"mc-button-submit btn light-green darken-4",name:"action",type:"submit"},[(0,o.eW)(" Обновить "),Gt],8,qt)]),(0,o.Lk)("div",Yt,[(0,o.Lk)("label",null,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":n[4]||(n[4]=e=>A.isNotPlanned=e),class:"filled-in",type:"checkbox"},null,512),[[l.lH,A.isNotPlanned]]),Qt])])])],32)])])],512))}});const Ht=(0,I.A)(Zt,[["__scopeId","data-v-9694da70"]]);var zt=Ht;const en=e=>((0,o.Qi)("data-v-ca22a03c"),e=e(),(0,o.jt)(),e),an={class:"modal-content"},tn=en((()=>(0,o.Lk)("h4",null,"Удаление операции",-1))),nn={class:"row"},ln={class:"col"},on=(0,o.Fv)('<div class="row" data-v-ca22a03c><div class="col" data-v-ca22a03c><p class="red-text" data-v-ca22a03c>Это действие необратимо</p></div></div><button class="btn modal-close-btn modal-close" data-v-ca22a03c><i class="large material-icons" data-v-ca22a03c>close</i></button>',2),cn={class:"row"},sn={class:"col"},rn=en((()=>(0,o.Lk)("i",{class:"material-icons right"},"delete_forever",-1))),un=en((()=>(0,o.Lk)("div",{class:"col"},[(0,o.Lk)("button",{class:"btn modal-close","data-target":"modalAddAccount"},[(0,o.Lk)("i",{class:"material-icons right"},"cancel"),(0,o.eW)(" Отменить удаление ")])],-1)));var dn=(0,o.pM)({__name:"DeleteTransactionComponent",setup(e){const{deleteTransaction:a}=(0,T.G)(),{selectedTransaction:t}=(0,W.bP)((0,T.G)()),{dateFilter:n,currencyFilter:r}=(0,P.c)(),u=(0,c.KR)(),i=(0,c.KR)(),d=()=>{a(),i.value.close()};let v;return(0,o.sV)((()=>{i.value=M.Modal.init(u.value)})),(0,o.Ic)((()=>{v=t.value?n(t.value.date):""})),(0,o.xo)((()=>{i.value.destroy()})),(e,a)=>((0,o.uX)(),(0,o.CE)("div",{id:"modalDeleteTransaction",ref_key:"deleteTransactionModal",ref:u,class:"modal"},[(0,o.Lk)("div",an,[tn,(0,o.Lk)("div",nn,[(0,o.Lk)("div",ln,[(0,o.Lk)("p",null,(0,s.v_)("income"===(0,c.R1)(t)?.type?"Доход":"outcome"===(0,c.R1)(t)?.type?"Расход":"Перевод")+" на сумму: "+(0,s.v_)((0,c.R1)(r)((0,c.R1)(t)?.amount)),1),(0,o.Lk)("p",null,"Дата: "+(0,s.v_)((0,c.R1)(v)),1),(0,o.Lk)("p",null,(0,s.v_)("transfer"===(0,c.R1)(t)?.type?"Счёт-отправитель":"Счёт")+": "+(0,s.v_)((0,c.R1)(t)?.account),1),(0,o.Lk)("p",null,(0,s.v_)("transfer"===(0,c.R1)(t)?.type?"Счёт-получатель":"Категория")+": "+(0,s.v_)((0,c.R1)(t)?.category),1),(0,o.Lk)("p",null,"Операция создана: "+(0,s.v_)((0,c.R1)(t)?.author),1)])]),on,(0,o.Lk)("div",cn,[(0,o.Lk)("div",sn,[(0,o.Lk)("button",{class:"btn red","data-target":"modalAddAccount",onClick:(0,l.D$)(d,["prevent"])},[rn,(0,o.eW)(" Удалить навсегда ")])]),un])])],512))}});const vn=(0,I.A)(dn,[["__scopeId","data-v-ca22a03c"]]);var mn=vn;const bn=e=>((0,o.Qi)("data-v-6fbd76bb"),e=e(),(0,o.jt)(),e),pn={class:"modal-content"},fn=bn((()=>(0,o.Lk)("h4",null,"Перевод средств со счёта на счёт",-1))),yn=bn((()=>(0,o.Lk)("button",{class:"btn modal-close-btn modal-close red"},[(0,o.Lk)("i",{class:"large material-icons"},"close")],-1))),kn={class:"mc-form-category"},gn={class:"row"},hn={class:"input-field col s12"},Ln=["value"],wn=bn((()=>(0,o.Lk)("label",null,"Выберите счёт-отправитель",-1))),Rn={class:"row"},An={class:"input-field col s12"},$n=["value"],_n=bn((()=>(0,o.Lk)("label",null,"Выберите счёт-получатель",-1))),xn={class:"row"},Cn={class:"input-field col s12"},En=bn((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"calendar_month",-1))),Nn=bn((()=>(0,o.Lk)("label",{for:"transferDate"},"Дата",-1))),Fn={class:"row"},In={class:"input-field col s12"},Kn=bn((()=>(0,o.Lk)("i",{class:"material-icons prefix"},"currency_ruble",-1))),Dn=bn((()=>(0,o.Lk)("label",{for:"amount"},"Сумма перевода",-1))),Tn={class:"row"},Pn={class:"col"},Wn={key:0,class:"red-text"},Mn={key:1,class:"red-text"},Xn={key:2,class:"red-text"},Sn={key:3,class:"red-text"},Un={class:"row"},Vn={class:"col"},jn=["disabled"],Bn=bn((()=>(0,o.Lk)("i",{class:"material-icons right"},"forward",-1)));var Jn=(0,o.pM)({__name:"EditAccountsTransferComponent",setup(e){const{accounts:a,selectedAccountId:t,selectedAccountName:n,destinationAccountId:r,destinationAccountName:u,transferAmount:d,requiredAmountForTransfer:v,isSourceAccountBalanceNotEnough:m}=(0,W.bP)((0,i.l)()),{editTransaction:b}=(0,T.G)(),{selectedTransaction:p,transactionDate:f}=(0,W.bP)((0,T.G)()),{selectedCategoryId:y}=(0,W.bP)((0,Ce.d)()),{currencyFilter:k}=(0,P.c)(),g=(0,c.KR)(),h=(0,c.KR)(),L=(0,c.KR)(),w=(0,c.KR)(),R=(0,c.KR)(),A=(0,o.EW)((()=>t.value===r.value||!t.value||!r.value)),$=(0,o.EW)((()=>A.value||m.value||d.value<=0)),_=async()=>{if($.value)return;const e={account:n.value,accountId:t.value,amount:d.value,category:u.value,categoryId:r.value,date:f.value,description:`Перевод из ${n.value} на ${u.value}`,type:"transfer"};await b(e),h.value.close()},x={onOpenStart:()=>{t.value=p.value?.accountId,r.value=p.value?.categoryId,d.value=p.value?.amount},onOpenEnd:()=>{xe().updateTextFields()},onCloseEnd:()=>{t.value="",y.value=""}};return(0,o.$u)((()=>{L.value=document.querySelectorAll("select"),xe().FormSelect.init(L.value),xe().updateTextFields()})),(0,o.sV)((()=>{h.value=xe().Modal.init(g.value,x),L.value=document.querySelectorAll("select"),xe().FormSelect.init(L.value),xe().updateTextFields(),R.value=xe().Datepicker.init(w.value,Ne)})),(0,o.xo)((()=>{h.value.destroy()})),(e,n)=>((0,o.uX)(),(0,o.CE)("div",{id:"modalEditTransfer",ref_key:"modalTransfer",ref:g,class:"modal"},[(0,o.Lk)("div",pn,[fn,yn,(0,o.Lk)("form",kn,[(0,o.Lk)("div",gn,[(0,o.Lk)("div",hn,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":n[0]||(n[0]=e=>(0,c.i9)(t)?t.value=e:null)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,c.R1)(a),(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,s.v_)(e.name)+" | "+(0,s.v_)((0,c.R1)(k)(e.balance)),9,Ln)))),128))],512),[[l.u1,(0,c.R1)(t)]]),wn])]),(0,o.Lk)("div",Rn,[(0,o.Lk)("div",An,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":n[1]||(n[1]=e=>(0,c.i9)(r)?r.value=e:null)},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)((0,c.R1)(a),(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,s.v_)(e.name)+" | "+(0,s.v_)((0,c.R1)(k)(e.balance)),9,$n)))),128))],512),[[l.u1,(0,c.R1)(r)]]),_n])]),(0,o.Lk)("div",xn,[(0,o.Lk)("div",Cn,[En,(0,o.Lk)("input",{id:"transferDate",ref_key:"datepicker",ref:w,class:"datepicker",name:"transferDate",type:"text"},null,512),Nn])]),(0,o.Lk)("div",Fn,[(0,o.Lk)("div",In,[Kn,(0,o.bo)((0,o.Lk)("input",{id:"amount","onUpdate:modelValue":n[2]||(n[2]=e=>(0,c.i9)(d)?d.value=e:null),step:"0.01",type:"number"},null,512),[[l.Jo,(0,c.R1)(d)]]),Dn])]),(0,o.Lk)("div",Tn,[(0,o.Lk)("div",Pn,[(0,c.R1)(t)?(0,c.R1)(r)?A.value?((0,o.uX)(),(0,o.CE)("small",Xn," Счёт-отправитель и счёт-получатель должны быть разными ")):(0,c.R1)(m)?((0,o.uX)(),(0,o.CE)("small",Sn,[(0,o.eW)(" На счете-отправителе не хватает "),(0,o.Lk)("strong",null,(0,s.v_)((0,c.R1)(k)((0,c.R1)(v).toString())),1)])):(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("small",Mn," Необходимо выбрать счёт-получатель ")):((0,o.uX)(),(0,o.CE)("small",Wn," Необходимо выбрать счёт-отправитель "))])]),(0,o.Lk)("div",Un,[(0,o.Lk)("div",Vn,[(0,o.Lk)("button",{disabled:$.value,class:"mc-button-submit btn blue",name:"action",type:"submit",onClick:(0,l.D$)(_,["prevent"])},[(0,o.eW)("Перевести "),Bn],8,jn)])])])])],512))}});const On=(0,I.A)(Jn,[["__scopeId","data-v-6fbd76bb"]]);var qn=On,Gn=(0,o.pM)({__name:"ModalComponent",setup(e){return(e,a)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(l.eB,{name:"modal"},{default:(0,o.k6)((()=>[(0,o.bF)(D)])),_:1}),(0,o.bF)(l.eB,{name:"modal"},{default:(0,o.k6)((()=>[(0,o.bF)($e)])),_:1}),(0,o.bF)(l.eB,{name:"modal"},{default:(0,o.k6)((()=>[(0,o.bF)(ne)])),_:1}),(0,o.bF)(l.eB,{name:"modal"},{default:(0,o.k6)((()=>[(0,o.bF)(va)])),_:1}),(0,o.bF)(l.eB,{name:"modal"},{default:(0,o.k6)((()=>[(0,o.bF)(Oa)])),_:1}),(0,o.bF)(l.eB,{name:"modal"},{default:(0,o.k6)((()=>[(0,o.bF)(yt)])),_:1}),(0,o.bF)(l.eB,{name:"modal"},{default:(0,o.k6)((()=>[(0,o.bF)(zt)])),_:1}),(0,o.bF)(l.eB,{name:"modal"},{default:(0,o.k6)((()=>[(0,o.bF)(mn)])),_:1}),(0,o.bF)(l.eB,{name:"modal"},{default:(0,o.k6)((()=>[(0,o.bF)(qn)])),_:1})],64))}});const Yn=Gn;var Qn=Yn,Zn=t(4416),Hn=t(7591),zn=t(1387);const el={class:"mc-main-background green lighten-5"},al={key:0,class:"fixed-action-btn"},tl=(0,o.Lk)("i",{class:"material-icons"},"add",-1),nl=[tl];var ll=(0,o.pM)({__name:"App",setup(e){const{isDataNeeded:a,areBaseAndCategoriesReady:n}=(0,W.bP)((0,Ga.X)()),{fetchUserInfo:l}=(0,Hn.x)(),{subscribeToAccounts:s}=(0,i.l)(),r=(0,zn.lq)(),u=(0,c.IJ)(),d=(0,c.KR)();return(0,o.wB)((()=>r.meta.layout??"MainLayout"),(e=>{u.value=(0,o.$V)((()=>t(62)(`./${e}.vue`)))}),{immediate:!0}),(0,o.KC)((async()=>{Zn.j.currentUser&&a.value&&(await l(),await s(),a.value=!1)})),(0,o.sV)((()=>{d.value&&M.FloatingActionButton.init(d.value,{direction:"right"})})),(e,a)=>{const t=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",el,[((0,o.uX)(),(0,o.Wv)((0,o.$y)(u.value),null,{default:(0,o.k6)((()=>[(0,o.bF)(t)])),_:1}))]),(0,c.R1)(n)?((0,o.uX)(),(0,o.CE)("div",al,[(0,o.Lk)("button",{ref_key:"addTransaction",ref:d,class:"btn-floating btn-large red modal-trigger","data-target":"modalAddTransaction"},nl,512)])):(0,o.Q3)("",!0),((0,o.uX)(),(0,o.Wv)(o.Im,{to:"body"},[(0,o.bF)(Qn)]))],64)}}});const ol=ll;var cl=ol,sl=t(4458);let rl=!1,ul=!0;(0,sl.k)("/service-worker.js",{ready(){rl=!1,ul=!0,console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading."),alert("Обнаружена новая версия приложения. Сейчас произойдет перезагрузка страницы."),rl=!0,ul=!1},updated(){rl&&!ul&&(console.log("refresh"),alert("Приложение будет обновлено"),ul=!0,rl=!1,window.location.replace("/")),console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode."),alert("Пропало соединение с интернетом")},error(e){console.error("Error during service worker registration:",e)}});var il=t(1459);t(8055);let dl;Zn.j.onAuthStateChanged((()=>{dl||(dl=(0,l.Ef)(cl),dl.use(n.A),dl.use(il.A),dl.mount("#app"))}))},1459:function(e,a,t){"use strict";var n=t(1387),l=t(4416);const o=[{name:"login",path:"/login",meta:{auth:!1},component:()=>t.e(427).then(t.bind(t,7427))},{name:"register",path:"/register",meta:{auth:!1},component:()=>t.e(835).then(t.bind(t,835))},{name:"profile",path:"/profile",meta:{auth:!0},component:()=>t.e(326).then(t.bind(t,3326))},{name:"accounts",path:"/accounts",meta:{auth:!0},component:()=>t.e(25).then(t.bind(t,25))},{name:"records",path:"/records",meta:{auth:!0,layout:"WideLayout"},component:()=>t.e(390).then(t.bind(t,7390))},{name:"planning",path:"/planning",meta:{auth:!0},component:()=>t.e(972).then(t.bind(t,7972))},{name:"calendar",path:"/calendar",meta:{auth:!0,layout:"WideLayout"},component:()=>t.e(669).then(t.bind(t,8669))},{name:"categories",path:"/categories",meta:{auth:!0},component:()=>t.e(812).then(t.bind(t,3812))},{name:"home",path:"/",meta:{auth:!0},component:()=>t.e(484).then(t.bind(t,7484))}],c=(0,n.aE)({history:(0,n.LA)("/"),routes:o});c.beforeEach((e=>{const a=!!l.j.currentUser,t=e.matched.some((e=>e.meta.auth));if(!e.name)return{name:"home"};if(t){if(a)return;if("login"!==e.name&&"register"!==e.name)return{name:"login"}}})),a.A=c},4574:function(e,a,t){"use strict";t.d(a,{l:function(){return m}});var n=t(3367),l=t(7591),o=t(8078),c=t(6995),s=t(5254),r=t(144),u=t(6768),i=t(4416),d=t(3220),v=t(6504);const m=(0,n.nY)("accounts",(()=>{const e=(0,r.KR)([]),a=(0,r.KR)(0),t=(0,r.KR)(""),m=(0,r.KR)(""),b=(0,r.KR)(0),p=(0,r.KR)(0),{pushNewTransaction:f}=(0,c.G)(),y=(0,u.EW)((()=>Object.values(e.value).sort(((e,a)=>e.name>a.name?1:e.name<a.name?-1:0)).sort(((e,a)=>e.isCountable&&!a.isCountable?-1:!e.isCountable&&a.isCountable?1:0)))),k=(0,u.EW)((()=>{const e=y.value.find((e=>e.id===t.value));return e?e.name:""})),g=(0,u.EW)((()=>{const e=y.value.find((e=>e.id===t.value));return e?e.balance:0})),h=(0,u.EW)((()=>y.value.find((e=>e.id===m.value))?.name||"")),L=(0,u.EW)((()=>{if(t.value){const e=y.value.find((e=>e.id===t.value))?.balance||0;return p.value=e-b.value,e<b.value}return!0})),w=(0,u.EW)((()=>y.value.reduce(((e,a)=>a.isCountable?e+a.balance:e),0))),R=async e=>{const{baseId:a}=(0,n.bP)((0,l.x)(v.A)),t={name:e.accountName,balance:e.balance,id:"",isCountable:e.isCountable,initialBalance:e.balance};try{const e=(0,d.VC)((0,d.KR)(i.db,`bases/${a.value}/accounts/`));"string"===typeof e.key&&(t.id=e.key),await(0,d.hZ)(e,t)}catch(o){console.error(o)}finally{await _()}},A=async e=>{try{const a={},{baseId:o}=(0,n.bP)((0,l.x)()),c=(0,d.KR)(i.db,`bases/${o.value}/accounts/${t.value}`),s=await(await(0,d.Jt)(c)).val(),r=s.balance>e.balance?"outcome":"income",u=Number(Math.abs(s.balance-e.balance).toFixed(2));s.name=e.accountName,s.balance=e.balance,s.isCountable=e.isCountable,a[`bases/${o.value}/accounts/${t.value}`]=s,t.value="";const v=(new Date).getFullYear(),m=(new Date).getMonth(),b=(new Date).getDate(),p={account:s.name,accountId:s.id,amount:u,category:s.name,categoryId:s.id,date:new Date(v,m,b).getTime(),description:`Корректировка (${"income"===r?"рост":"понижение"}) баланса счёта ${s.name.toUpperCase()} на сумму ${Math.abs(u)}`,isNotPlanned:!1,readonly:!0,type:r};return await f(p),(0,d.yo)((0,d.KR)(i.db),a)}catch(a){console.error(a)}},$=async()=>{try{const{baseId:e}=(0,n.bP)((0,l.x)()),a=(0,d.KR)(i.db,`bases/${e.value}/accounts/${t.value}`);t.value="",await(0,d.hZ)(a,null)}catch(e){console.error(e)}},_=async()=>{const{subscribeToCategories:t}=(0,o.d)(),{subscribeToTransactions:r}=(0,c.G)(),{subscribeToLimits:u}=(0,s.A)();try{const{baseId:o}=(0,n.bP)((0,l.x)());if(o.value){const n=(0,d.KR)(i.db,`bases/${o.value}/accounts/`);(0,d.Zy)(n,(async n=>{n.exists()?(e.value=n.val(),await t(),await r(),await u()):a.value<5?setTimeout((()=>{a.value++,_()}),100*(a.value+1)):(e.value=[],console.error("Не существует пути до СЧЕТОВ"))}))}else console.error("BaseID is empty or null")}catch(v){console.error(v)}};return{accounts:y,selectedAccountId:t,destinationAccountId:m,destinationAccountName:h,transferAmount:b,requiredAmountForTransfer:p,isSourceAccountBalanceNotEnough:L,selectedAccountName:k,selectedAccountBalance:g,allAccountsSum:w,subscribeToAccounts:_,pushNewAccount:R,changeAccount:A,deleteAccount:$}}))},6380:function(e,a,t){"use strict";t.d(a,{n:function(){return m}});t(4114);var n=t(3367),l=t(6504),o=t(4416),c=t(3220),s=t(6486),r=t(1459),u=t(144),i=t(4574),d=t(7591),v=t(2132);const m=(0,n.nY)("auth",(()=>{const e=(0,u.KR)(0);function a(){e.value+=1}async function t({email:e,password:t}){const{subscribeToAccounts:c}=(0,i.l)(l.A),{fetchUserInfo:u}=(0,d.x)(l.A),{isGlobalLoading:m}=(0,n.bP)((0,v.X)(l.A));try{m.value=!0,await(0,s.x9)(o.j,e,t),await u(),await c(),await r.A.push("/profile"),a()}catch(b){console.error(b)}finally{m.value=!1}}async function m({firstName:e,lastName:t,email:u,password:m}){const{subscribeToAccounts:b}=(0,i.l)(l.A),{fetchUserInfo:f}=(0,d.x)(l.A),{isGlobalLoading:y}=(0,n.bP)((0,v.X)(l.A));try{y.value=!0,await(0,s.eJ)(o.j,u,m);const n=p();n?await(0,c.hZ)((0,c.KR)(o.db,`/users/${n}/`),{firstName:e,lastName:t,email:u,id:n,recordsId:""}):console.error("UID is null or empty"),await f(),await b(),await r.A.push("/profile"),a()}catch(k){console.error(k)}finally{y.value=!1}}async function b(){try{await(0,s.CI)(o.j),await r.A.push("/"),a()}catch(e){}}function p(){const e=o.j.currentUser;return e?e.uid:null}return{register:m,getUid:p,login:t,logout:b,componentKey:e}}))},8078:function(e,a,t){"use strict";t.d(a,{d:function(){return v}});var n=t(3367),l=t(3220),o=t(4416),c=t(144),s=t(6768),r=t(6504),u=t(7591),i=t(5254),d=t(6995);const v=(0,n.nY)("categories",(()=>{const e=(0,c.KR)([]),a=(0,c.KR)(""),t=(0,c.KR)(0),{outcomeTransactions:v}=(0,n.bP)((0,d.G)(r.A)),{limitsYearMonth:m}=(0,n.bP)((0,i.A)(r.A)),b=(0,s.EW)((()=>Object.values(e.value).sort(((e,a)=>e.name>a.name?1:e.name<a.name?-1:0)))),p=(0,s.EW)((()=>b.value.filter((e=>"outcome"===e.type)))),f=(0,s.EW)((()=>p.value?.map((e=>{const a=v.value.filter((a=>a.categoryId===e.id)).sort(((e,a)=>e.date-a.date)).filter((e=>e.isForecast))||[],t=v.value.filter((a=>a.categoryId===e.id)).filter((e=>!e.isForecast)).reduce(((e,a)=>Number((e+=+a.amount).toFixed(2))),0);let n,l;n=0!==m.value.length?m.value.find((a=>a.categoryId===e.id)):null,l=n?n.limit:0;const o=t-l>0?Number((t-l).toFixed(2)):0,c=l>0?100*t/l:l,s=c>100?100:c,r=c<80?"green":c<100?"yellow":"red";return{...e,records:a,spend:t,limit:l,overspend:o,progressPercent:s,progressColor:r}})).sort(((e,a)=>e.name>a.name?1:e.name<a.name?-1:0)))),y=(0,s.EW)((()=>b.value.find((e=>e.id===a.value)))),k=async e=>{const{baseId:a,userFullName:t}=(0,n.bP)((0,u.x)()),c={name:e["categoryName"],type:e["categoryType"],id:"",author:t.value,description:e["categoryDescription"]};try{const e=(0,l.VC)((0,l.KR)(o.db,`bases/${a.value}/categories/`));"string"===typeof e.key&&(c.id=e.key),await(0,l.hZ)(e,c)}catch(s){console.error(s)}},g=async e=>{const{baseId:t,userFullName:c}=(0,n.bP)((0,u.x)());e.categoryAuthor=c.value;const s={name:e.categoryName,type:e.categoryType,id:e.categoryId,author:e.categoryAuthor,description:e.categoryDescription};try{const e={};return e[`bases/${t.value}/categories/${a.value}`]=s,a.value="",(0,l.yo)((0,l.KR)(o.db),e)}catch(r){console.error(r)}},h=async()=>{try{const{baseId:e}=(0,n.bP)((0,u.x)()),t=(0,l.KR)(o.db,`bases/${e.value}/categories/${a.value}`);a.value="",await(0,l.hZ)(t,null)}catch(e){console.error(e)}},L=async()=>{try{const{baseId:a}=(0,n.bP)((0,u.x)()),c=(0,l.KR)(o.db,`bases/${a.value}/categories/`);(0,l.Zy)(c,(async a=>{a.exists()?e.value=a.val():t.value<5?setTimeout((()=>{t.value++,L()}),100*(t.value+1)):(e.value=[],console.error("Не существует пути до КАТЕГОРИЙ"))}))}catch(a){console.error(a)}};return{categories:b,categoriesAvailableForLimitation:p,limitCategories:f,selectedCategoryId:a,selectedCategory:y,pushNewCategory:k,changeCategory:g,deleteCategory:h,subscribeToCategories:L}}))},7591:function(e,a,t){"use strict";t.d(a,{x:function(){return d}});var n=t(6504),l=t(3367),o=t(6380),c=t(4574),s=t(3220),r=t(4416),u=t(144),i=t(6768);const d=(0,l.nY)("database",(()=>{const{getUid:e}=(0,o.n)(n.A),{subscribeToAccounts:a}=(0,c.l)(n.A),t=(0,u.Kh)({firstName:"",lastName:"",email:"",id:"",recordsId:""}),l=(0,u.KR)(""),d=(0,i.EW)((()=>t.recordsId)),v=(0,i.EW)((()=>`${t.firstName} ${t.lastName}`));async function m(){try{const a=e();if(a){await(0,s.hZ)((0,s.KR)(r.db,`/bases/${a}/info/`),{createdAt:(new Date).getTime()}),t.recordsId=a;const e={};return e[`/users/${a}/`]=t,(0,s.yo)((0,s.KR)(r.db),e)}console.error("UID is empty or null")}catch(n){console.error(n)}finally{await a()}}async function b(){try{const a=e();if(a){t.recordsId=l.value;const e={};return e[`/users/${a}/`]=t,(0,s.yo)((0,s.KR)(r.db),e)}console.error("UID is empty or null")}catch(n){console.error(n)}finally{await a()}}async function p(){try{const a=e(),n=await(await(0,s.Jt)((0,s.jf)((0,s.KR)(r.db),`users/${a}/`))).val();n&&""!==n.id?(t.firstName=n.firstName,t.id=n.id,t.lastName=n.lastName,t.email=n.email,t.recordsId=n.recordsId):console.error("You are not logged in")}catch(a){console.error(a)}}return{userInfo:t,recordsIdAttach:l,baseId:d,userFullName:v,fetchUserInfo:p,attachUserBase:b,createNewUserBase:m}}))},6459:function(e,a,t){"use strict";t.d(a,{c:function(){return l}});var n=t(3367);const l=(0,n.nY)("filters",(()=>{const e=(e,a="RUB")=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:a}).format(e),a=(e,a="date")=>{const t={};return a.includes("date")&&(t.day="2-digit",t.month="long",t.year="numeric"),a.includes("time")&&(t.hour="2-digit",t.minute="2-digit",t.second="2-digit"),new Intl.DateTimeFormat("ru-RU",t).format(new Date(e))};return{currencyFilter:e,dateFilter:a}}))},6504:function(e,a,t){"use strict";var n=t(3367);const l=(0,n.Ey)();a.A=l},5254:function(e,a,t){"use strict";t.d(a,{A:function(){return v}});var n=t(3367),l=t(144),o=t(6768),c=t(7591),s=t(3220),r=t(3649),u=t(4416),i=t(6504),d=t(6995);const v=(0,n.nY)("limits",(()=>{const{transactionsYearFilter:e,transactionsMonthFilter:a}=(0,n.bP)((0,d.G)(i.A)),t=(0,l.KR)([]),v=(0,l.KR)(new Date),m=(0,l.KR)(0),b=(0,l.KR)(0),p=(0,o.EW)((()=>0===t.value.length?[]:t.value[e.value]&&t.value[e.value][a.value]?Object.values(t.value[e.value][a.value]):[])),f=(0,o.EW)((()=>0===t.value.length?[]:Object.values(t.value))),y=async e=>{const a={},{baseId:t}=(0,n.bP)((0,c.x)(i.A)),l=p.value.find((a=>a.categoryId===e.categoryId)),o=0===e.limit;let d;try{return o&&l?(a[`bases/${t.value}/limits/${e.year}/${e.month}/${l.id}`]=null,(0,s.yo)((0,r.KR)(u.db),a)):(l?(e.id=l.id,a[`bases/${t.value}/limits/${e.year}/${e.month}/${l.id}`]=e):(d=(0,s.VC)((0,r.KR)(u.db,`bases/${t.value}/limits/${e.year}/${e.month}/`)),"string"===typeof d.key&&(e.id=d.key),a[`bases/${t.value}/limits/${e.year}/${e.month}/${e.id}`]=e),console.log(a),(0,s.yo)((0,r.KR)(u.db),a))}catch(v){console.error(v)}},k=async()=>{try{const{baseId:e}=(0,n.bP)((0,c.x)(i.A)),a=(0,r.KR)(u.db,`bases/${e.value}/limits/`);(0,s.Zy)(a,(async e=>{e.exists()?t.value=e.val():b.value<5?setTimeout((()=>{b.value++,k()}),100*(b.value+1)):(t.value=[],console.error("Не существует пути до ЛИМИТОВ"))}))}catch(e){console.error(e)}};return{limitsYearMonth:p,setLimitValue:m,today:v,limits:f,pushNewLimit:y,subscribeToLimits:k}}))},2132:function(e,a,t){"use strict";t.d(a,{X:function(){return i}});var n=t(3367),l=t(144),o=t(6768),c=t(7591),s=t(4574),r=t(8078),u=t(6995);const i=(0,n.nY)("status",(()=>{const e=(0,l.KR)(!1),a=(0,l.KR)(!0),t=(0,o.EW)((()=>{const{userInfo:e}=(0,n.bP)((0,c.x)());return""!==e.value.recordsId})),i=(0,o.EW)((()=>{const{accounts:e}=(0,n.bP)((0,s.l)());return e.value.length>0})),d=(0,o.EW)((()=>{const{categories:e}=(0,n.bP)((0,r.d)());return e.value.length>0})),v=(0,o.EW)((()=>{const{transactions:e}=(0,n.bP)((0,u.G)());return e.value.length>0})),m=(0,o.EW)((()=>t.value&&i.value&&d.value)),b=(0,o.EW)((()=>m.value&&v.value));return{isGlobalLoading:e,isDataNeeded:a,areBaseAndCategoriesReady:m,isBaseReady:t,isAccountExist:i,isCategoryExist:d,isTransactionExist:v,isAdvisorReadyToStart:b}}))},6995:function(e,a,t){"use strict";t.d(a,{G:function(){return v}});var n=t(3367),l=t(144),o=t(6768),c=t(7591),s=t(3649),r=t(4416),u=t(3220),i=t(6504),d=t(8078);const v=(0,n.nY)("transactions",(()=>{const e=(0,l.KR)([]),a=(0,l.KR)(""),t=(0,l.KR)(0),v=(0,l.KR)((new Date).getTime()),m=(0,l.KR)((new Date).getMonth()),b=(0,l.KR)((new Date).getFullYear()),p=(0,o.EW)((()=>Object.values(e.value))),f=(0,o.EW)((()=>12!==m.value?p.value.filter((e=>new Date(e.date).getFullYear()===b.value)).filter((e=>new Date(e.date).getMonth()===m.value)).sort(((e,a)=>a.date-e.date)):p.value.filter((e=>new Date(e.date).getFullYear()===b.value)).sort(((e,a)=>a.date-e.date)))),y=(0,o.EW)((()=>{const{selectedCategoryId:e}=(0,n.bP)((0,d.d)(i.A));return e.value?p.value.filter((a=>a.categoryId===e.value)):[]})),k=(0,o.EW)((()=>12!==m.value?p.value.filter((e=>"outcome"===e.type)).filter((e=>new Date(e.date).getFullYear()===b.value)).filter((e=>new Date(e.date).getMonth()===m.value)):p.value.filter((e=>"outcome"===e.type)).filter((e=>new Date(e.date).getFullYear()===b.value)))),g=(0,o.EW)((()=>p.value.find((e=>e.id===a.value)))),h=e=>{v.value=e.getTime()},L=(0,o.EW)((()=>new Date(b.value,m.value+1,0).getDate())),w=async e=>{const{baseId:a,userFullName:t}=(0,n.bP)((0,c.x)()),l={account:e.account,accountId:e.accountId,amount:e.amount,author:t.value,category:e.category,categoryId:e.categoryId,createdAt:(new Date).getTime(),date:e.date,description:e.description,id:"",isForecast:e.date>(new Date).getTime(),isNotPlanned:e.isNotPlanned,readonly:e.readonly,type:e.type};try{const e=(0,u.VC)((0,s.KR)(r.db,`bases/${a.value}/transactions/`));if(l.id=e.key,l.isForecast)await(0,u.hZ)(e,l);else{switch(l.type){case"transfer":await $(l,a.value);break;case"outcome":await A(l,a.value);break;default:await R(l,a.value);break}await(0,u.hZ)(e,l)}}catch(o){console.error(o)}},R=async(e,a)=>{if(!a&&!e)return;const t={},n=(0,s.KR)(r.db,`bases/${a}/accounts/${e.accountId}`),l=await(await(0,u.Jt)(n)).val();return l.balance+=e.amount,l.balance=Number(l.balance.toFixed(2)),t[`bases/${a}/accounts/${e.accountId}`]=l,(0,u.yo)((0,s.KR)(r.db),t)},A=async(e,a)=>{if(!a&&!e)return;const t={},n=(0,s.KR)(r.db,`bases/${a}/accounts/${e.accountId}`),l=await(await(0,u.Jt)(n)).val();return l.balance-=e.amount,l.balance=Number(l.balance.toFixed(2)),t[`bases/${a}/accounts/${e.accountId}`]=l,(0,u.yo)((0,s.KR)(r.db),t)},$=async(e,a)=>{if(!a&&!e)return;const t={},n=(0,s.KR)(r.db,`bases/${a}/accounts/${e.accountId}`),l=await(await(0,u.Jt)(n)).val();l.balance-=e.amount,l.balance=Number(l.balance.toFixed(2)),t[`bases/${a}/accounts/${e.accountId}`]=l;const o=(0,s.KR)(r.db,`bases/${a}/accounts/${e.categoryId}`),c=await(await(0,u.Jt)(o)).val();return c.balance+=e.amount,c.balance=Number(c.balance.toFixed(2)),t[`bases/${a}/accounts/${e.categoryId}`]=c,(0,u.yo)((0,s.KR)(r.db),t)},_=async e=>{if(!g.value)return;if(!e)return;const a=g.value,{baseId:t,userFullName:l}=(0,n.bP)((0,c.x)()),o={},i="transfer"===a.type,d=a.accountId===e.accountId,v=a.categoryId===e.categoryId;try{const n=(0,s.KR)(r.db,`bases/${t.value}/accounts/${a.accountId}`),c=await(await(0,u.Jt)(n)).val(),m=(0,s.KR)(r.db,`bases/${t.value}/accounts/${a.categoryId}`),b=await(await(0,u.Jt)(m)).val();a.isForecast||("income"===a.type?(c.balance-=a.amount,c.balance=Number(c.balance.toFixed(2))):"outcome"===a.type?(c.balance+=a.amount,c.balance=Number(c.balance.toFixed(2))):i&&(c.balance+=a.amount,c.balance=Number(c.balance.toFixed(2)),b.balance-=a.amount,b.balance=Number(b.balance.toFixed(2)),o[`bases/${t.value}/accounts/${b.id}`]=b),o[`bases/${t.value}/accounts/${c.id}`]=c),Object.keys(a).forEach((t=>{Object.hasOwn(e,t)&&(a[t]=e[t]),"author"===t&&(a[t]=l.value),"isForecast"===t&&(a[t]=a.date>(new Date).getTime())})),o[`bases/${t.value}/transactions/${a.id}`]=a;let p=c,f=b;if(!a.isForecast){if(i){if(d&&v)p=c,f=b;else if(d&&!v){p=c;const e=(0,s.KR)(r.db,`bases/${t.value}/accounts/${a.categoryId}`);f=await(await(0,u.Jt)(e)).val()}else if(!d&&v){const e=(0,s.KR)(r.db,`bases/${t.value}/accounts/${a.accountId}`);p=await(await(0,u.Jt)(e)).val(),f=b}else if(!d&&!v){const e=(0,s.KR)(r.db,`bases/${t.value}/accounts/${a.accountId}`);p=await(await(0,u.Jt)(e)).val();const n=(0,s.KR)(r.db,`bases/${t.value}/accounts/${a.categoryId}`);f=await(await(0,u.Jt)(n)).val()}}else if(d)p=c;else{const e=(0,s.KR)(r.db,`bases/${t.value}/accounts/${a.accountId}`);p=await(await(0,u.Jt)(e)).val()}"income"===a.type?(p.balance+=a.amount,p.balance=Number(p.balance.toFixed(2))):"outcome"===a.type?(p.balance-=a.amount,p.balance=Number(p.balance.toFixed(2))):i&&(p.balance-=a.amount,p.balance=Number(p.balance.toFixed(2)),f.balance+=a.amount,f.balance=Number(f.balance.toFixed(2)),o[`bases/${t.value}/accounts/${f.id}`]=f),o[`bases/${t.value}/accounts/${p.id}`]=p}return(0,u.yo)((0,s.KR)(r.db),o)}catch(m){console.error(m)}},x=async()=>{if(!g.value)return;const e={},{baseId:a}=(0,n.bP)((0,c.x)());try{const t=(0,s.KR)(r.db,`bases/${a.value}/accounts/${g.value.accountId}`),n=(0,s.KR)(r.db,`bases/${a.value}/transactions/${g.value.id}`),l=await(await(0,u.Jt)(t)).val(),o=await(await(0,u.Jt)(n)).val();return l.balance=Number((l.balance-o.amount).toFixed(2)),o.isForecast=!1,e[`bases/${a.value}/accounts/${l.id}`]=l,e[`bases/${a.value}/transactions/${o.id}`]=o,(0,u.yo)((0,s.KR)(r.db),e)}catch(t){console.log(t)}},C=async()=>{if(g.value)try{const{baseId:e}=(0,n.bP)((0,c.x)()),t=(0,s.KR)(r.db,`bases/${e.value}/transactions/${a.value}`),l=(0,s.KR)(r.db,`bases/${e.value}/accounts/${g.value.accountId}`),o=await(await(0,u.Jt)(l)).val();let i;if(!g.value?.isForecast){if("income"===g.value.type)o.balance-=g.value.amount,o.balance=Number(o.balance.toFixed(2));else if("outcome"===g.value.type)o.balance+=g.value.amount,o.balance=Number(o.balance.toFixed(2));else if("transfer"===g.value.type){const a=(0,s.KR)(r.db,`bases/${e.value}/accounts/${g.value?.categoryId}`);i=await(await(0,u.Jt)(a)).val(),o.balance+=g.value.amount,o.balance=Number(o.balance.toFixed(2)),i.balance-=g.value.amount,i.balance=Number(i.balance.toFixed(2)),await(0,u.hZ)(a,i)}await(0,u.hZ)(l,o)}a.value="",await(0,u.hZ)(t,null)}catch(e){console.error(e)}},E=async()=>{try{const{baseId:a}=(0,n.bP)((0,c.x)()),l=(0,s.KR)(r.db,`bases/${a.value}/transactions/`);(0,u.Zy)(l,(async a=>{a.exists()?e.value=a.val():t.value<5?setTimeout((()=>{t.value++,E()}),100*(t.value+1)):(e.value=[],console.error("Не существует пути до ТРАНЗАКЦИЙ"))}))}catch(a){console.error(a)}};return{transactions:p,transactionsByCategory:y,selectedTransactionId:a,selectedTransaction:g,transactionDate:v,transactionsMonthFilter:m,transactionsYearFilter:b,transactionsSortedByDate:f,outcomeTransactions:k,daysInMonth:L,pushNewTransaction:w,editTransaction:_,changeTransactionToRegular:x,deleteTransaction:C,subscribeToTransactions:E,getNewDate:h}}))},4416:function(e,a,t){"use strict";t.d(a,{db:function(){return u},j:function(){return r}});var n=t(6400),l=t(6486),o=t(3220);const c={apiKey:"AIzaSyDYNJW9zQZPj0XGCU_jinDaqUWB4-c3Xa8",authDomain:"money-catcher-65750.firebaseapp.com",projectId:"money-catcher-65750",storageBucket:"money-catcher-65750.appspot.com",messagingSenderId:"413859778767",appId:"1:413859778767:web:ba8898f1e968b6e68d27ba",measurementId:"G-SPDWJ2B7P9",databaseURL:"https://money-catcher-65750-default-rtdb.europe-west1.firebasedatabase.app/"},s=(0,n.Wp)(c),r=(0,l.xI)(s),u=(0,o.C3)(s)},62:function(e,a,t){var n={"./MainLayout.vue":[9272,272],"./WideLayout.vue":[2131,131]};function l(e){if(!t.o(n,e))return Promise.resolve().then((function(){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}));var a=n[e],l=a[0];return t.e(a[1]).then((function(){return t(l)}))}l.keys=function(){return Object.keys(n)},l.id=62,e.exports=l}},a={};function t(n){var l=a[n];if(void 0!==l)return l.exports;var o=a[n]={exports:{}};return e[n].call(o.exports,o,o.exports,t),o.exports}t.m=e,function(){var e=[];t.O=function(a,n,l,o){if(!n){var c=1/0;for(i=0;i<e.length;i++){n=e[i][0],l=e[i][1],o=e[i][2];for(var s=!0,r=0;r<n.length;r++)(!1&o||c>=o)&&Object.keys(t.O).every((function(e){return t.O[e](n[r])}))?n.splice(r--,1):(s=!1,o<c&&(c=o));if(s){e.splice(i--,1);var u=l();void 0!==u&&(a=u)}}return a}o=o||0;for(var i=e.length;i>0&&e[i-1][2]>o;i--)e[i]=e[i-1];e[i]=[n,l,o]}}(),function(){t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,{a:a}),a}}(),function(){t.d=function(e,a){for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})}}(),function(){t.f={},t.e=function(e){return Promise.all(Object.keys(t.f).reduce((function(a,n){return t.f[n](e,a),a}),[]))}}(),function(){t.u=function(e){return"js/"+e+"."+{25:"71901051",131:"82cf9b35",272:"45c2c8d7",326:"35690047",390:"775bea60",427:"fb9d435a",484:"3b6460a3",669:"b85620a0",812:"8934dd7e",835:"c668b63d",972:"ced29ace"}[e]+".js"}}(),function(){t.miniCssF=function(e){return"css/"+e+"."+{25:"312c0cfb",131:"a9a91eb7",272:"9f68ca41",326:"aace4cdc",390:"954e09e2",427:"484841c9",669:"6a257267",835:"b197f489",972:"84e1ffb7"}[e]+".css"}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){var e={},a="money-catcher:";t.l=function(n,l,o,c){if(e[n])e[n].push(l);else{var s,r;if(void 0!==o)for(var u=document.getElementsByTagName("script"),i=0;i<u.length;i++){var d=u[i];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==a+o){s=d;break}}s||(r=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,t.nc&&s.setAttribute("nonce",t.nc),s.setAttribute("data-webpack",a+o),s.src=n),e[n]=[l];var v=function(a,t){s.onerror=s.onload=null,clearTimeout(m);var l=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),l&&l.forEach((function(e){return e(t)})),a)return a(t)},m=setTimeout(v.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=v.bind(null,s.onerror),s.onload=v.bind(null,s.onload),r&&document.head.appendChild(s)}}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){t.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,a,n,l,o){var c=document.createElement("link");c.rel="stylesheet",c.type="text/css",t.nc&&(c.nonce=t.nc);var s=function(t){if(c.onerror=c.onload=null,"load"===t.type)l();else{var n=t&&t.type,s=t&&t.target&&t.target.href||a,r=new Error("Loading CSS chunk "+e+" failed.\n("+n+": "+s+")");r.name="ChunkLoadError",r.code="CSS_CHUNK_LOAD_FAILED",r.type=n,r.request=s,c.parentNode&&c.parentNode.removeChild(c),o(r)}};return c.onerror=c.onload=s,c.href=a,n?n.parentNode.insertBefore(c,n.nextSibling):document.head.appendChild(c),c},a=function(e,a){for(var t=document.getElementsByTagName("link"),n=0;n<t.length;n++){var l=t[n],o=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(o===e||o===a))return l}var c=document.getElementsByTagName("style");for(n=0;n<c.length;n++){l=c[n],o=l.getAttribute("data-href");if(o===e||o===a)return l}},n=function(n){return new Promise((function(l,o){var c=t.miniCssF(n),s=t.p+c;if(a(c,s))return l();e(n,s,null,l,o)}))},l={524:0};t.f.miniCss=function(e,a){var t={25:1,131:1,272:1,326:1,390:1,427:1,669:1,835:1,972:1};l[e]?a.push(l[e]):0!==l[e]&&t[e]&&a.push(l[e]=n(e).then((function(){l[e]=0}),(function(a){throw delete l[e],a})))}}}(),function(){var e={524:0};t.f.j=function(a,n){var l=t.o(e,a)?e[a]:void 0;if(0!==l)if(l)n.push(l[2]);else{var o=new Promise((function(t,n){l=e[a]=[t,n]}));n.push(l[2]=o);var c=t.p+t.u(a),s=new Error,r=function(n){if(t.o(e,a)&&(l=e[a],0!==l&&(e[a]=void 0),l)){var o=n&&("load"===n.type?"missing":n.type),c=n&&n.target&&n.target.src;s.message="Loading chunk "+a+" failed.\n("+o+": "+c+")",s.name="ChunkLoadError",s.type=o,s.request=c,l[1](s)}};t.l(c,r,"chunk-"+a,a)}},t.O.j=function(a){return 0===e[a]};var a=function(a,n){var l,o,c=n[0],s=n[1],r=n[2],u=0;if(c.some((function(a){return 0!==e[a]}))){for(l in s)t.o(s,l)&&(t.m[l]=s[l]);if(r)var i=r(t)}for(a&&a(n);u<c.length;u++)o=c[u],t.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return t.O(i)},n=self["webpackChunkmoney_catcher"]=self["webpackChunkmoney_catcher"]||[];n.forEach(a.bind(null,0)),n.push=a.bind(null,n.push.bind(n))}();var n=t.O(void 0,[504],(function(){return t(6744)}));n=t.O(n)})();