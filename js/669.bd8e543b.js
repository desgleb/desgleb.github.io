"use strict";(self["webpackChunkmoney_catcher"]=self["webpackChunkmoney_catcher"]||[]).push([[669],{5509:function(e,a,t){t.d(a,{$:function(){return l}});const l=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"]},24:function(e,a,t){t.d(a,{A:function(){return f}});var l=t(6768),r=t(144),n=t(4232),o=t(5130),i=t(6995),d=t(3367),u=t(5509);const c={class:"input-field"},s={key:0,selected:"",value:"12"},v=["value"],m=(0,l.Lk)("label",null,"Фильтрация по месяцам",-1);var y=(0,l.pM)({__name:"MonthSelectComponent",props:{showAll:{type:Boolean}},setup(e){const{transactionsMonthFilter:a}=(0,d.bP)((0,i.G)()),t=(0,r.KR)(),y=(0,r.KR)();return(0,l.sV)((()=>{y.value=M.FormSelect.init(t.value)})),(e,i)=>((0,l.uX)(),(0,l.CE)("div",c,[(0,l.bo)((0,l.Lk)("select",{ref_key:"monthSelect",ref:t,"onUpdate:modelValue":i[0]||(i[0]=e=>(0,r.i9)(a)?a.value=e:null)},[e.$props.showAll?((0,l.uX)(),(0,l.CE)("option",s,"Показать всё")):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,r.R1)(u.$),((e,a)=>((0,l.uX)(),(0,l.CE)("option",{key:a,value:a},(0,n.v_)(e),9,v)))),128))],512),[[o.u1,(0,r.R1)(a),void 0,{number:!0}]]),m]))}});const _=y;var f=_},2122:function(e,a,t){t.d(a,{A:function(){return _}});t(4114);var l=t(6768),r=t(144),n=t(4232),o=t(5130),i=t(6995),d=t(3367),u=t(2132);const c={class:"input-field"},s=["value"],v=(0,l.Lk)("label",null,"Фильтрация по годам",-1);var m=(0,l.pM)({__name:"YearSelectComponent",setup(e){const{transactions:a,transactionsYearFilter:t}=(0,d.bP)((0,i.G)()),{isGlobalLoading:m}=(0,d.bP)((0,u.X)());m.value=!0;const y=(0,r.KR)(),_=(0,r.KR)(),f=(0,l.EW)((()=>{const e=[],t=new Set;t.add((new Date).getFullYear()),a.value.forEach((e=>{const a=new Date(e.date).getFullYear();t.add(a)}));const l=Math.max.apply(null,Array.from(t))+1;t.add(l);const r=Array.from(t).sort(((e,a)=>e-a));return r.forEach((a=>{const t={year:a,id:Math.floor(1e6*Math.random())};e.push(t)})),m.value=!1,e}));return(0,l.sV)((()=>{_.value=M.FormSelect.init(y.value)})),(0,l.$u)((()=>{_.value=M.FormSelect.init(y.value)})),(e,a)=>((0,l.uX)(),(0,l.CE)("div",c,[(0,l.bo)((0,l.Lk)("select",{ref_key:"yearSelect",ref:y,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,r.i9)(t)?t.value=e:null)},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(f.value,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e.id,value:e.year},(0,n.v_)(e.year),9,s)))),128))],512),[[o.u1,(0,r.R1)(t),void 0,{number:!0}]]),v]))}});const y=m;var _=y},8669:function(e,a,t){t.r(a),t.d(a,{default:function(){return Z}});var l=t(6768),r=(t(4114),t(4232)),n=t(144),o=t(6459),i=t(6995),d=t(8078),u=t(5254),c=t(4574),s=t(3367);const v=e=>((0,l.Qi)("data-v-19b988bc"),e=e(),(0,l.jt)(),e),m={class:"day-card__header"},y={class:"row valign-wrapper"},_={class:"col s12"},f={class:"center-align day-card__date"},p={class:"row valign-center blue lighten-3"},k={class:"col s12"},b={class:"center-align day-card__balance"},g={key:0,class:"valign-center"},F={class:"col s12 red white-text"},h=v((()=>(0,l.Lk)("div",{class:"center-align day-card__overspending"},"Не учтено ",-1))),L={class:"center-align day-card__overspending"},E={class:"day-card__section day-card__section-income green lighten-4"},w={class:"center-align day-card__income-list-item"},C={class:"day-card__section day-card__section-outcome orange lighten-4"},N={class:"center-align day-card__income-list-item"},x={class:"center-align day-card__income-list"},I={class:"day-card__section day-card__section-outcome red lighten-3"},X={class:"center-align day-card__income-list-item"},R={class:"center-align day-card__income-list"},M={class:"day-card__footer"},W={class:"valign-center"},D={class:"col s12"};var P=(0,l.pM)({__name:"CalendarDayCardComponent",props:{day:{}},setup(e){const a=e,{dateFilter:t,currencyFilter:v}=(0,o.c)(),{transactions:P,transactionsSortedByDate:S}=(0,s.bP)((0,i.G)()),{categoriesAvailableForLimitation:T}=(0,s.bP)((0,d.d)()),{limits:A}=(0,s.bP)((0,u.A)()),{accounts:K}=(0,s.bP)((0,c.l)()),G=new Date(a.day.year,a.day.month,a.day.day).getTime(),V=new Date(a.day.year,a.day.month,a.day.day+1).getTime(),Y=new Date(a.day.year,a.day.month,0).getDate(),$=new Date(a.day.year,a.day.month-1,Y).getTime(),B=(0,l.EW)((()=>K.value.map((e=>{const a=P.value.filter((e=>"transfer"===e.type)).filter((e=>e.date<G)).reduce(((a,t)=>t.accountId===e.id?Number((a-t.amount).toFixed(2)):t.categoryId===e.id?Number((a+t.amount).toFixed(2)):Number(a.toFixed(2))),0),t=P.value.filter((a=>a.accountId===e.id)).filter((e=>"income"===e.type)).filter((e=>e.date<G)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0),l=P.value.filter((a=>a.accountId===e.id)).filter((e=>"outcome"===e.type)).filter((e=>e.date<G)).reduce(((e,a)=>Number((e-a.amount).toFixed(2))),0);let r;return r=e.isCountable?e.initialBalance+a+t+l:0,{...e,resultSumTillToday:r}})).reduce(((e,a)=>Number((e+a.resultSumTillToday).toFixed(2))),0))),Q=(0,l.EW)((()=>K.value.map((e=>{const a=S.value.filter((e=>"transfer"===e.type)).filter((e=>e.date===G)).reduce(((a,t)=>t.accountId!==e.id||e.isCountable?t.categoryId!==e.id||e.isCountable?Number(a.toFixed(2)):Number((a-t.amount).toFixed(2)):Number((a+t.amount).toFixed(2))),0);return{...e,transfersToday:a}})).reduce(((e,a)=>Number((e+a.transfersToday).toFixed(2))),0))),U=(0,l.EW)((()=>Number(B.value+z.value-J.value-O.value))),j=(0,l.EW)((()=>T.value.map((e=>{const a=S.value.filter((e=>e.date>=G)).filter((e=>e.date<V)).filter((e=>!e.isNotPlanned)).filter((a=>a.categoryId===e.id)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0),t=A.value.find((a=>a.categoryId===e.id))?.limit||0,l=t>0&&a-t>0?Number((a-t).toFixed(2)):0;return{...e,overspend:l}})).filter((e=>e.overspend>0)).reduce(((e,a)=>Number((e+a.overspend).toFixed(2))),0))),q=(0,l.EW)((()=>S.value.filter((e=>"transfer"!==e.type)).filter((e=>e.date<V)).filter((e=>e.date>=G)))),z=(0,l.EW)((()=>{const e=q.value.filter((e=>"income"===e.type)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0),a=Q.value>0?e+Q.value:e;return Number(a.toFixed(2))})),H=(0,l.EW)((()=>q.value.filter((e=>"outcome"===e.type)).filter((e=>!e.isNotPlanned)))),J=(0,l.EW)((()=>{const e=H.value.reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0),a=Q.value<0?e+Math.abs(Q.value):e;return Number(a.toFixed(2))})),O=(0,l.EW)((()=>q.value.filter((e=>"outcome"===e.type)).filter((e=>e.isNotPlanned)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0))),Z=(0,l.EW)((()=>S.value.filter((e=>e.isNotPlanned)).filter((e=>e.date>$)).filter((e=>e.date<=G)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0))),ee=(0,l.EW)((()=>T.value.map((e=>{const a=q.value.filter((e=>!e.isNotPlanned)).filter((a=>a.categoryId===e.id)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0),t=q.value.filter((a=>a.categoryId===e.id)).filter((e=>"outcome"===e.type)).find((e=>e.isForecast)),l=!!t&&t.isForecast;return{...e,total:a,hasForecast:l}})).filter((e=>0!==e.total)))),ae=(0,l.EW)((()=>T.value.map((e=>{const a=q.value.filter((e=>e.isNotPlanned)).filter((a=>a.categoryId===e.id)).reduce(((e,a)=>Number((e+a.amount).toFixed(2))),0);return{...e,total:a}})).filter((e=>0!==e.total))));return(e,a)=>((0,l.uX)(),(0,l.CE)("article",{class:(0,r.C4)([{"border-red":U.value<0},"card-panel grey lighten-2 calendar-list__card day-card"])},[(0,l.Lk)("header",m,[(0,l.Lk)("div",y,[(0,l.Lk)("div",_,[(0,l.Lk)("div",f,(0,r.v_)((0,n.R1)(t)((0,n.R1)(G))),1)])]),(0,l.Lk)("div",p,[(0,l.Lk)("div",k,[(0,l.Lk)("div",b,[(0,l.Lk)("strong",null,"Утром "+(0,r.v_)((0,n.R1)(v)(B.value)),1)])])]),Z.value+j.value>0?((0,l.uX)(),(0,l.CE)("div",g,[(0,l.Lk)("div",F,[h,(0,l.Lk)("div",L,(0,r.v_)((0,n.R1)(v)(Z.value+j.value)),1)])])):(0,l.Q3)("",!0)]),(0,l.Lk)("section",E,[(0,l.Lk)("div",w,[(0,l.Lk)("strong",null,"Доход "+(0,r.v_)((0,n.R1)(v)(z.value)),1)])]),(0,l.Lk)("section",C,[(0,l.Lk)("div",N,[(0,l.Lk)("strong",null,"Расход "+(0,r.v_)((0,n.R1)(v)(J.value)),1)]),(0,l.Lk)("ul",x,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(ee.value,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e.id,class:(0,r.C4)([{"grey-text":e["hasForecast"]},"day-card__income-list-item"])},(0,r.v_)(e.name)+" - "+(0,r.v_)((0,n.R1)(v)(e["total"])),3)))),128))])]),(0,l.Lk)("section",I,[(0,l.Lk)("div",X,[(0,l.Lk)("strong",null,"Вне плана "+(0,r.v_)((0,n.R1)(v)(O.value)),1)]),(0,l.Lk)("ul",R,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(ae.value,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e.id,class:"day-card__income-list-item"},(0,r.v_)(e.name)+" - "+(0,r.v_)((0,n.R1)(v)(e["total"])),1)))),128))])]),(0,l.Lk)("footer",M,[(0,l.Lk)("div",W,[(0,l.Lk)("div",D,[(0,l.Lk)("div",{class:(0,r.C4)([{"red lighten-4":U.value<0,green:U.value>=0},"center-align day-card__balance"])},[(0,l.Lk)("strong",null,"Вечером "+(0,r.v_)((0,n.R1)(v)(U.value)),1)],2)])])])],2))}}),S=t(1241);const T=(0,S.A)(P,[["__scopeId","data-v-19b988bc"]]);var A=T;const K={class:"calendar-list"};var G=(0,l.pM)({__name:"CalendarGridComponent",setup(e){const{transactionsMonthFilter:a,transactionsYearFilter:t}=(0,s.bP)((0,i.G)()),n=["Su","Mo","Tu","We","Th","Fr","Sa"],o=(0,l.EW)((()=>new Date(t.value,a.value+1,0).getDate())),d=(0,l.EW)((()=>{const e=[];let l=1;for(let r=1;r<=o.value;r++){const o={id:0,week:0,day:0,month:0,weekday:0,weekdayName:"",year:0};o.day=r,o.month=a.value,o.year=t.value,o.weekday=new Date(t.value,a.value,r).getDay(),o.weekdayName=n[o.weekday],o.week=l,o.id=new Date(o.year,o.month,o.day).getTime(),e.push(o),0===o.weekday&&l++}return e}));return(e,a)=>((0,l.uX)(),(0,l.CE)("ul",K,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(d.value,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e.id,style:(0,r.Tr)({"grid-area":e.weekdayName,"grid-row":e.week}),class:"calendar-list__item"},[(0,l.bF)(A,{day:e},null,8,["day"])],4)))),128))]))}});const V=(0,S.A)(G,[["__scopeId","data-v-717b28f5"]]);var Y=V,$=t(24),B=t(2122);const Q=(0,l.Lk)("div",{class:"container"},[(0,l.Lk)("h3",null,"Календарь")],-1),U=(0,l.Lk)("hr",null,null,-1),j={class:"row"},q={class:"col s12 m2 offset-m7"},z={class:"col s12 m3"},H={class:"row table-scrollable"};var J=(0,l.pM)({__name:"CalendarView",setup(e){return(e,a)=>((0,l.uX)(),(0,l.CE)(l.FK,null,[Q,U,(0,l.Lk)("div",j,[(0,l.Lk)("div",q,[(0,l.bF)(B.A)]),(0,l.Lk)("div",z,[(0,l.bF)($.A,{"show-all":!1})])]),(0,l.Lk)("div",H,[(0,l.bF)(Y)])],64))}});const O=J;var Z=O}}]);