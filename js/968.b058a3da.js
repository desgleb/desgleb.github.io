"use strict";(self["webpackChunkmoney_catcher"]=self["webpackChunkmoney_catcher"]||[]).push([[968],{5509:function(e,l,t){t.d(l,{$:function(){return a}});const a=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"]},24:function(e,l,t){t.d(l,{A:function(){return g}});var a=t(6768),n=t(144),r=t(4232),s=t(5130),u=t(6995),o=t(3367),i=t(5509),c=t(8078);const d={class:"input-field"},v={key:0,selected:"",value:"12"},k=["value"],m=(0,a.Lk)("label",null,"Месяц",-1);var L=(0,a.pM)({__name:"MonthSelectComponent",props:{showAll:{type:Boolean}},setup(e){const{transactionsMonthFilter:l}=(0,o.bP)((0,u.G)()),{selectedCategoryId:t}=(0,o.bP)((0,c.d)()),L=(0,n.KR)(),p=(0,n.KR)();return(0,a.sV)((()=>{p.value=M.FormSelect.init(L.value)})),(0,a.$u)((()=>{t.value=""})),(e,t)=>((0,a.uX)(),(0,a.CE)("div",d,[(0,a.bo)((0,a.Lk)("select",{ref_key:"monthSelect",ref:L,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,n.i9)(l)?l.value=e:null)},[e.$props.showAll?((0,a.uX)(),(0,a.CE)("option",v,"Показать всё")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,n.R1)(i.$),((e,l)=>((0,a.uX)(),(0,a.CE)("option",{key:l,value:l},(0,r.v_)(e),9,k)))),128))],512),[[s.u1,(0,n.R1)(l),void 0,{number:!0}]]),m]))}});const p=L;var g=p},2122:function(e,l,t){t.d(l,{A:function(){return p}});t(4114);var a=t(6768),n=t(144),r=t(4232),s=t(5130),u=t(6995),o=t(3367),i=t(2132),c=t(8078);const d={class:"input-field"},v=["value"],k=(0,a.Lk)("label",null,"Год",-1);var m=(0,a.pM)({__name:"YearSelectComponent",setup(e){const{transactions:l,transactionsYearFilter:t}=(0,o.bP)((0,u.G)()),{selectedCategoryId:m}=(0,o.bP)((0,c.d)()),{isGlobalLoading:L}=(0,o.bP)((0,i.X)());L.value=!0;const p=(0,n.KR)(),g=(0,n.KR)(),h=(0,a.EW)((()=>{const e=[],t=new Set;t.add((new Date).getFullYear()),l.value.forEach((e=>{const l=new Date(e.date).getFullYear();t.add(l)}));const a=Math.max.apply(null,Array.from(t))+1;t.add(a);const n=Array.from(t).sort(((e,l)=>e-l));return n.forEach((l=>{const t={year:l,id:Math.floor(1e6*Math.random())};e.push(t)})),L.value=!1,e}));return(0,a.sV)((()=>{g.value=M.FormSelect.init(p.value)})),(0,a.$u)((()=>{m.value="",g.value=M.FormSelect.init(p.value)})),(e,l)=>((0,a.uX)(),(0,a.CE)("div",d,[(0,a.bo)((0,a.Lk)("select",{ref_key:"yearSelect",ref:p,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,n.i9)(t)?t.value=e:null)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(h.value,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.year},(0,r.v_)(e.year),9,v)))),128))],512),[[s.u1,(0,n.R1)(t),void 0,{number:!0}]]),k]))}});const L=m;var p=L},6968:function(e,l,t){t.r(l),t.d(l,{default:function(){return q}});var a=t(6768),n=t(144),r=t(4232),s=t(24),u=t(2122),o=t(3367),i=t(8078),c=t(6995),d=t(6459);const v=e=>((0,a.Qi)("data-v-17e4a0ec"),e=e(),(0,a.jt)(),e),k=v((()=>(0,a.Lk)("h3",null,"Планирование",-1))),m=v((()=>(0,a.Lk)("hr",null,null,-1))),L={key:0,class:"row"},p={class:"col"},g=v((()=>(0,a.Lk)("p",null,"У Вас нет ни одной расходной категории.",-1))),h={key:1,class:"row"},b={key:0,class:"red-text"},y={key:2},f={class:"row valign-wrapper"},C={class:"col s12 m4"},E=["disabled"],_=v((()=>(0,a.Lk)("i",{class:"material-icons right"},"calculate",-1))),F={class:"col s12 m2 offset-m3"},R={class:"col s12 m3"},w={class:"row scrollable"},X={key:0,class:"row"},x={key:0,class:"red-text"},W={class:"progress"},M={class:"highlight centered responsive-table"},T=v((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"Дата"),(0,a.Lk)("th",null,"Счёт"),(0,a.Lk)("th",null,"Сумма"),(0,a.Lk)("th",{class:"fixed-width"},"Комментарий"),(0,a.Lk)("th",{class:"fixed-width"},"Действия")])],-1))),A={class:"row mb-0 flex-center"},S={class:"col"},K=["id"],P=v((()=>(0,a.Lk)("i",{class:"material-icons"},"done_all",-1))),I=[P],N={class:"col"},Q=["id","data-target"],D=v((()=>(0,a.Lk)("i",{class:"material-icons"},"edit",-1))),G=[D],V={class:"col"},$=["id"],Y=v((()=>(0,a.Lk)("i",{class:"material-icons"},"delete",-1))),B=[Y];var U=(0,a.pM)({__name:"PlanningView",setup(e){const{categoriesAvailableForLimitation:l,limitCategories:t}=(0,o.bP)((0,i.d)()),{selectedTransactionId:v,transactionsMonthFilter:P,transactionsSortedByDate:D}=(0,o.bP)((0,c.G)()),{changeTransactionToRegular:Y}=(0,c.G)(),{currencyFilter:U,dateFilter:j}=(0,d.c)(),O=(0,a.EW)((()=>D.value.filter((e=>"income"===e.type)).reduce(((e,l)=>Number((e+l.amount).toFixed(2))),0))),q=(0,a.EW)((()=>{if(12===P.value){let e=t.value.reduce(((e,l)=>Number((e+l.limit).toFixed(2))),0);return e*=P.value,e}return t.value.reduce(((e,l)=>Number((e+l.limit).toFixed(2))),0)})),z=(0,a.EW)((()=>t.value.reduce(((e,l)=>Number((e+l.spend).toFixed(2))),0))),H=(0,a.EW)((()=>t.value.reduce(((e,l)=>Number((e+l.overspend).toFixed(2))),0))),J=(0,a.EW)((()=>O.value-q.value)),Z=(0,a.EW)((()=>O.value-z.value)),ee=e=>{let l;l="BUTTON"===e.target.tagName?e.target:e.target.parentElement,v.value=l.id};let le=0;const te=async e=>{const l=e;try{if(le++,ee(l),!v.value)return;await Y()}catch(t){console.log(t),le<5&&setTimeout((()=>te(l)),100)}};return(e,o)=>{const i=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)(a.FK,null,[k,m,0===(0,n.R1)(l).length?((0,a.uX)(),(0,a.CE)("div",L,[(0,a.Lk)("div",p,[g,(0,a.Lk)("p",null,[(0,a.eW)("Добавьте хотя бы одну расходную "),(0,a.bF)(i,{to:"/categories"},{default:(0,a.k6)((()=>[(0,a.eW)("категорию")])),_:1})])])])):((0,a.uX)(),(0,a.CE)("div",h,[(0,a.Lk)("h5",null,[(0,a.eW)(" Запланировано расходов: "+(0,r.v_)((0,n.R1)(U)(q.value))+". Израсходовано: "+(0,r.v_)((0,n.R1)(U)(z.value))+". ",1),H.value>0?((0,a.uX)(),(0,a.CE)("small",b," Перерасход: "+(0,r.v_)((0,n.R1)(U)(H.value)),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("h5",null," Запланировано доходов: "+(0,r.v_)((0,n.R1)(U)(O.value)),1),(0,a.Lk)("h5",null,[(0,a.Lk)("strong",null,[(0,a.Lk)("span",{class:(0,r.C4)({"red-text":J.value<0,"green-text":J.value>=0})},"Итоги планирования: "+(0,r.v_)((0,n.R1)(U)(J.value))+".",3),(0,a.eW)("  "),(0,a.Lk)("span",{class:(0,r.C4)({"red-text":Z.value<0,"green-text":Z.value>=0})},"Фактическое сальдо: "+(0,r.v_)((0,n.R1)(U)(Z.value)),3)])])])),(0,n.R1)(t).length>0?((0,a.uX)(),(0,a.CE)("section",y,[(0,a.Lk)("div",f,[(0,a.Lk)("div",C,[(0,a.Lk)("button",{disabled:0===(0,n.R1)(l).length,class:"btn modal-trigger","data-target":"modalSetLimit"},[_,(0,a.eW)(" Установить лимит ")],8,E)]),(0,a.Lk)("div",F,[(0,a.bF)(u.A)]),(0,a.Lk)("div",R,[(0,a.bF)(s.A,{"show-all":!0})])]),(0,a.Lk)("div",w,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,n.R1)(t),(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id},[e&&(e.limit>0||e.records.length>0||e.spend>0)?((0,a.uX)(),(0,a.CE)("div",X,[(0,a.Lk)("p",null,[(0,a.Lk)("strong",null,(0,r.v_)(e.name),1),(0,a.eW)(" "+(0,r.v_)((0,n.R1)(U)(e.spend))+" из "+(0,r.v_)((0,n.R1)(U)(e.limit))+" ",1),e.overspend>0?((0,a.uX)(),(0,a.CE)("small",x,"Перерасход на "+(0,r.v_)((0,n.R1)(U)(e.overspend)),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",W,[(0,a.Lk)("div",{class:(0,r.C4)([[e.progressColor],"determinate"]),style:(0,r.Tr)({width:e.progressPercent+"%"})},null,6)]),(0,a.Lk)("table",M,[T,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.records,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",{class:(0,r.C4)({"red-text":e.date<(new Date).getTime()})},(0,r.v_)((0,n.R1)(j)(e["date"])),3),(0,a.Lk)("td",null,(0,r.v_)(e["account"]),1),(0,a.Lk)("td",null,(0,r.v_)((0,n.R1)(U)(e["amount"])),1),(0,a.Lk)("td",null,(0,r.v_)(e["description"]),1),(0,a.Lk)("td",null,[(0,a.Lk)("div",A,[(0,a.Lk)("div",S,[(0,a.Lk)("button",{id:e.id,class:"green btn",onClick:te},I,8,K)]),(0,a.Lk)("div",N,[(0,a.Lk)("button",{id:e.id,"data-target":"transfer"===e.type?"modalEditTransfer":"modalEditTransaction",class:"yellow btn modal-trigger black-text",onClick:ee},G,8,Q)]),(0,a.Lk)("div",V,[(0,a.Lk)("button",{id:e.id,class:"red btn modal-trigger","data-target":"modalDeleteTransaction",onClick:ee},B,8,$)])])])])))),128))])])])):(0,a.Q3)("",!0)])))),128))])])):(0,a.Q3)("",!0)],64)}}}),j=t(1241);const O=(0,j.A)(U,[["__scopeId","data-v-17e4a0ec"]]);var q=O}}]);