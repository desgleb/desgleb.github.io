{"version":3,"file":"js/58.c3115005.js","mappings":"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","sources":["webpack://money-catcher/./src/views/PlanningView.vue?8a4b","webpack://money-catcher/./src/views/PlanningView.vue","webpack://money-catcher/./src/views/PlanningView.vue?9fd6"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"h3\", null, \"Планирование\", -1)\nconst _hoisted_2 = {\n  key: 0,\n  class: \"row\"\n}\nconst _hoisted_3 = { class: \"col\" }\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"p\", null, \"У Вас нет ни одной расходной категории.\", -1)\nconst _hoisted_5 = {\n  key: 1,\n  class: \"row\"\n}\nconst _hoisted_6 = { class: \"col\" }\nconst _hoisted_7 = [\"disabled\"]\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"i\", { class: \"material-icons right\" }, \"calculate\", -1)\nconst _hoisted_9 = { key: 2 }\nconst _hoisted_10 = { key: 0 }\nconst _hoisted_11 = {\n  key: 0,\n  class: \"red-text\"\n}\nconst _hoisted_12 = { class: \"progress\" }\n\nimport { storeToRefs } from 'pinia';\r\nimport { useCategoriesStore } from '@/stores/categories';\r\nimport { useTransactionsStore } from '@/stores/transactions';\r\nimport { usePlanningStore } from '@/stores/limits';\r\nimport { useFiltersStore } from '@/stores/filters';\r\nimport { computed } from 'vue';\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'PlanningView',\n  setup(__props) {\n\r\nconst { categoriesAvailableForLimitation } = storeToRefs(useCategoriesStore());\r\nconst { outcomeTransactionsInThisMonth } = storeToRefs(useTransactionsStore());\r\nconst { limits } = storeToRefs(usePlanningStore());\r\nconst { currencyFilter } = useFiltersStore();\r\n\r\nconst limitCategories = computed(() => {\r\n  return categoriesAvailableForLimitation.value.map((cat) => {\r\n    const spend: number = outcomeTransactionsInThisMonth.value\r\n      .filter((tr) => tr.categoryId === cat.id)\r\n      .reduce((total, record): number => {\r\n        // noinspection JSUnusedAssignment\r\n        return Number((total += +record.amount).toFixed(2));\r\n      }, 0);\r\n\r\n    const limitInfo = limits.value.find((lim) => lim.categoryId === cat.id);\r\n\r\n    let limit: number;\r\n    if (!!limitInfo) {\r\n      limit = limitInfo.limit;\r\n    } else {\r\n      limit = 0;\r\n    }\r\n\r\n    const overspend: number = Number((spend - limit).toFixed(2));\r\n\r\n    const percent: number = limit > 0 ? (100 * spend) / limit : limit;\r\n    const progressPercent: number = percent > 100 ? 100 : percent;\r\n\r\n    const progressColor: string = percent < 80 ? 'green' : percent < 100 ? 'yellow' : 'red';\r\n\r\n    return {\r\n      ...cat,\r\n      spend,\r\n      limit,\r\n      overspend,\r\n      progressPercent,\r\n      progressColor\r\n    };\r\n  });\r\n});\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_router_link = _resolveComponent(\"router-link\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _hoisted_1,\n    (_unref(categoriesAvailableForLimitation).length === 0)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n          _createElementVNode(\"div\", _hoisted_3, [\n            _hoisted_4,\n            _createElementVNode(\"p\", null, [\n              _createTextVNode(\"Добавьте хотя бы одну расходную \"),\n              _createVNode(_component_router_link, { to: \"/categories\" }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"категорию\")\n                ]),\n                _: 1\n              })\n            ])\n          ])\n        ]))\n      : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n          _createElementVNode(\"div\", _hoisted_6, [\n            _createElementVNode(\"button\", {\n              disabled: _unref(categoriesAvailableForLimitation).length === 0,\n              class: \"btn modal-trigger\",\n              \"data-target\": \"modalSetLimit\"\n            }, [\n              _hoisted_8,\n              _createTextVNode(\" Установить лимит \")\n            ], 8, _hoisted_7)\n          ])\n        ])),\n    (limitCategories.value.length > 0)\n      ? (_openBlock(), _createElementBlock(\"section\", _hoisted_9, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(limitCategories.value, (cat) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n              key: cat.id!\n            }, [\n              (!!cat)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                    _createElementVNode(\"p\", null, [\n                      _createElementVNode(\"strong\", null, _toDisplayString(cat.name), 1),\n                      _createTextVNode(\" \" + _toDisplayString(_unref(currencyFilter)(cat.spend)) + \" из \" + _toDisplayString(_unref(currencyFilter)(cat.limit)) + \" \", 1),\n                      (cat.overspend > 0)\n                        ? (_openBlock(), _createElementBlock(\"small\", _hoisted_11, \"Перерасход на \" + _toDisplayString(_unref(currencyFilter)(cat.overspend)), 1))\n                        : _createCommentVNode(\"\", true)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_12, [\n                      _createElementVNode(\"div\", {\n                        class: _normalizeClass([[cat.progressColor], \"determinate\"]),\n                        style: _normalizeStyle({ width: cat.progressPercent + '%' })\n                      }, null, 6)\n                    ])\n                  ]))\n                : _createCommentVNode(\"\", true)\n            ]))\n          }), 128))\n        ]))\n      : _createCommentVNode(\"\", true)\n  ], 64))\n}\n}\n\n})","<template>\r\n  <h3>Планирование</h3>\r\n  <div v-if=\"categoriesAvailableForLimitation.length === 0\" class=\"row\">\r\n    <div class=\"col\">\r\n      <p>У Вас нет ни одной расходной категории.</p>\r\n      <p>Добавьте хотя бы одну расходную\r\n        <router-link to=\"/categories\">категорию</router-link>\r\n      </p>\r\n    </div>\r\n  </div>\r\n  <div v-else class=\"row\">\r\n    <div class=\"col\">\r\n      <button\r\n        :disabled=\"categoriesAvailableForLimitation.length === 0\"\r\n        class=\"btn modal-trigger\"\r\n        data-target=\"modalSetLimit\">\r\n        <i class=\"material-icons right\">calculate</i>\r\n        Установить лимит\r\n      </button>\r\n    </div>\r\n  </div>\r\n\r\n  <section v-if=\"limitCategories.length > 0\">\r\n    <div v-for=\"cat in limitCategories\" :key=\"cat.id!\">\r\n      <div v-if=\"!!cat\">\r\n        <p>\r\n          <strong>{{ cat.name }}</strong>\r\n          {{ currencyFilter(cat.spend) }} из {{ currencyFilter(cat.limit) }}\r\n          <small v-if=\"cat.overspend > 0\" class=\"red-text\">Перерасход на {{ currencyFilter(cat.overspend) }}</small>\r\n        </p>\r\n        <div class=\"progress\">\r\n          <div\r\n            :class=\"[cat.progressColor]\"\r\n            :style=\"{ width: cat.progressPercent + '%' }\"\r\n            class=\"determinate\"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </section>\r\n\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { storeToRefs } from 'pinia';\r\nimport { useCategoriesStore } from '@/stores/categories';\r\nimport { useTransactionsStore } from '@/stores/transactions';\r\nimport { usePlanningStore } from '@/stores/limits';\r\nimport { useFiltersStore } from '@/stores/filters';\r\nimport { computed } from 'vue';\r\n\r\nconst { categoriesAvailableForLimitation } = storeToRefs(useCategoriesStore());\r\nconst { outcomeTransactionsInThisMonth } = storeToRefs(useTransactionsStore());\r\nconst { limits } = storeToRefs(usePlanningStore());\r\nconst { currencyFilter } = useFiltersStore();\r\n\r\nconst limitCategories = computed(() => {\r\n  return categoriesAvailableForLimitation.value.map((cat) => {\r\n    const spend: number = outcomeTransactionsInThisMonth.value\r\n      .filter((tr) => tr.categoryId === cat.id)\r\n      .reduce((total, record): number => {\r\n        // noinspection JSUnusedAssignment\r\n        return Number((total += +record.amount).toFixed(2));\r\n      }, 0);\r\n\r\n    const limitInfo = limits.value.find((lim) => lim.categoryId === cat.id);\r\n\r\n    let limit: number;\r\n    if (!!limitInfo) {\r\n      limit = limitInfo.limit;\r\n    } else {\r\n      limit = 0;\r\n    }\r\n\r\n    const overspend: number = Number((spend - limit).toFixed(2));\r\n\r\n    const percent: number = limit > 0 ? (100 * spend) / limit : limit;\r\n    const progressPercent: number = percent > 100 ? 100 : percent;\r\n\r\n    const progressColor: string = percent < 80 ? 'green' : percent < 100 ? 'yellow' : 'red';\r\n\r\n    return {\r\n      ...cat,\r\n      spend,\r\n      limit,\r\n      overspend,\r\n      progressPercent,\r\n      progressColor\r\n    };\r\n  });\r\n});\r\n</script>","import script from \"./PlanningView.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./PlanningView.vue?vue&type=script&lang=ts&setup=true\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["_hoisted_1","_createElementVNode","_hoisted_2","key","class","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_defineComponent","__name","setup","__props","categoriesAvailableForLimitation","storeToRefs","useCategoriesStore","outcomeTransactionsInThisMonth","useTransactionsStore","limits","usePlanningStore","currencyFilter","useFiltersStore","limitCategories","computed","value","map","cat","spend","filter","tr","categoryId","id","reduce","total","record","Number","amount","toFixed","limitInfo","find","lim","limit","overspend","percent","progressPercent","progressColor","_ctx","_cache","_component_router_link","_resolveComponent","_openBlock","_createElementBlock","_Fragment","_unref","length","_createTextVNode","_createVNode","to","default","_withCtx","_","disabled","_renderList","_toDisplayString","name","_createCommentVNode","_normalizeClass","style","_normalizeStyle","width","__exports__"],"sourceRoot":""}