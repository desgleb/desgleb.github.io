"use strict";(self["webpackChunkmoney_catcher"]=self["webpackChunkmoney_catcher"]||[]).push([[62],{3062:function(e,l,t){t.r(l),t.d(l,{default:function(){return M}});var a=t(3396),i=t(7139),n=t(4870),r=t(1020),s=t(1520),d=t(9545),o=t(6135),c=t(3256);const u=e=>((0,a.dD)("data-v-5d9725b3"),e=e(),(0,a.Cn)(),e),_=u((()=>(0,a._)("h3",null,"Планирование",-1))),g=u((()=>(0,a._)("hr",null,null,-1))),m={class:"red-text"},v=u((()=>(0,a._)("hr",null,null,-1))),w={key:0,class:"row"},k={class:"col"},h=u((()=>(0,a._)("p",null,"У Вас нет ни одной расходной категории.",-1))),b={key:1,class:"row"},p={class:"col"},y=["disabled"],U=u((()=>(0,a._)("i",{class:"material-icons right"},"calculate",-1))),f={key:2},F={key:0},D={key:0,class:"red-text"},z={class:"progress"},C={class:"highlight centered responsive-table"},S=u((()=>(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"Дата"),(0,a._)("th",null,"Счёт"),(0,a._)("th",null,"Сумма"),(0,a._)("th",null,"Комментарий"),(0,a._)("th",null,"Действия")])],-1))),x={class:"row mb-0 flex-center"},T={class:"col"},N=["id"],I=u((()=>(0,a._)("i",{class:"material-icons"},"done_all",-1))),P=[I],q={class:"col"},E=["id","data-target"],H=u((()=>(0,a._)("i",{class:"material-icons"},"edit",-1))),J=[H],L={class:"col"},Y=["id"],K=u((()=>(0,a._)("i",{class:"material-icons"},"delete",-1))),Z=[K];var j=(0,a.aZ)({__name:"PlanningView",setup(e){const{categoriesAvailableForLimitation:l}=(0,r.Jk)((0,s.x)()),{selectedTransactionId:t,outcomeTransactionsInThisMonth:u}=(0,r.Jk)((0,d.C)()),{changeTransactionToRegular:I}=(0,d.C)(),{limits:H}=(0,r.Jk)((0,o.L)()),{currencyFilter:K,dateFilter:j}=(0,c.y)(),A=(0,a.Fl)((()=>l.value.map((e=>{const l=u.value.filter((l=>l.categoryId===e.id)).filter((e=>e.isForecast))||[],t=u.value.filter((l=>l.categoryId===e.id)).filter((e=>!e.isForecast)).reduce(((e,l)=>Number((e+=+l.amount).toFixed(2))),0),a=H.value.find((l=>l.categoryId===e.id));let i;i=a?a.limit:0;const n=Number((t-i).toFixed(2)),r=i>0?100*t/i:i,s=r>100?100:r,d=r<80?"green":r<100?"yellow":"red";return{...e,records:l,spend:t,limit:i,overspend:n,progressPercent:s,progressColor:d}})))),B=(0,a.Fl)((()=>A.value.reduce(((e,l)=>Number((e+l.limit).toFixed(2))),0))),M=(0,a.Fl)((()=>A.value.reduce(((e,l)=>Number((e+l.spend).toFixed(2))),0))),O=(0,a.Fl)((()=>u.value.filter((e=>e.isNotPlanned)).reduce(((e,l)=>Number((e+l.amount).toFixed(2))),0))),R=e=>{let l;l="BUTTON"===e.target.tagName?e.target:e.target.parentElement,t.value=l.id},V=async e=>{R(e),t.value&&await I()};return(e,t)=>{const r=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[_,g,(0,a._)("h5",null,[(0,a.Uk)("Запланировано: "+(0,i.zw)((0,n.SU)(K)(B.value))+". Израсходовано: "+(0,i.zw)((0,n.SU)(K)(M.value))+". ",1),(0,a._)("small",m,"Перерасход: "+(0,i.zw)((0,n.SU)(K)(M.value+O.value-B.value)),1)]),v,0===(0,n.SU)(l).length?((0,a.wg)(),(0,a.iD)("div",w,[(0,a._)("div",k,[h,(0,a._)("p",null,[(0,a.Uk)("Добавьте хотя бы одну расходную "),(0,a.Wm)(r,{to:"/categories"},{default:(0,a.w5)((()=>[(0,a.Uk)("категорию")])),_:1})])])])):((0,a.wg)(),(0,a.iD)("div",b,[(0,a._)("div",p,[(0,a._)("button",{disabled:0===(0,n.SU)(l).length,class:"btn modal-trigger","data-target":"modalSetLimit"},[U,(0,a.Uk)(" Установить лимит ")],8,y)])])),A.value.length>0?((0,a.wg)(),(0,a.iD)("section",f,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(A.value,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id,class:"row"},[e?((0,a.wg)(),(0,a.iD)("div",F,[(0,a._)("p",null,[(0,a._)("strong",null,(0,i.zw)(e.name),1),(0,a.Uk)(" "+(0,i.zw)((0,n.SU)(K)(e.spend))+" из "+(0,i.zw)((0,n.SU)(K)(e.limit))+" ",1),e.overspend>0?((0,a.wg)(),(0,a.iD)("small",D,"Перерасход на "+(0,i.zw)((0,n.SU)(K)(e.overspend)),1)):(0,a.kq)("",!0)]),(0,a._)("div",z,[(0,a._)("div",{class:(0,i.C_)([[e.progressColor],"determinate"]),style:(0,i.j5)({width:e.progressPercent+"%"})},null,6)]),(0,a._)("table",C,[S,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.records,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,(0,i.zw)((0,n.SU)(j)(e["date"])),1),(0,a._)("td",null,(0,i.zw)(e["account"]),1),(0,a._)("td",null,(0,i.zw)((0,n.SU)(K)(e["amount"])),1),(0,a._)("td",null,(0,i.zw)(e["description"]),1),(0,a._)("td",null,[(0,a._)("div",x,[(0,a._)("div",T,[(0,a._)("button",{id:e.id,class:"green btn",onClick:V},P,8,N)]),(0,a._)("div",q,[(0,a._)("button",{id:e.id,"data-target":"transfer"===e.type?"modalEditTransfer":"modalEditTransaction",class:"yellow btn modal-trigger black-text",onClick:R},J,8,E)]),(0,a._)("div",L,[(0,a._)("button",{id:e.id,class:"red btn modal-trigger","data-target":"modalDeleteTransaction",onClick:R},Z,8,Y)])])])])))),128))])])])):(0,a.kq)("",!0)])))),128))])):(0,a.kq)("",!0)],64)}}}),A=t(89);const B=(0,A.Z)(j,[["__scopeId","data-v-5d9725b3"]]);var M=B}}]);
//# sourceMappingURL=62.068c589a.js.map